<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AI Life - Complete Optimization Platform</title>
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #667eea; --primary-light: #a78bfa; --secondary: #00ffd4; --accent: #a855f7;
            --success: #00ff88; --warning: #ffaa00; --error: #ff4757; --info: #00d4ff;
            --text-primary: #ffffff; --text-secondary: rgba(255, 255, 255, 0.9); --text-muted: rgba(255, 255, 255, 0.7);
            
            --ai-primary: linear-gradient(135deg, #667eea 0%, #a855f7 50%, #00ffd4 100%);
            --ai-emotion: linear-gradient(135deg, #8b5cf6 0%, #ec4899 25%, #06b6d4 50%, #10b981 75%, #f59e0b 100%);
            --ai-productivity: linear-gradient(135deg, #10b981 0%, #00ffd4 50%, #667eea 100%);
            --ai-health: linear-gradient(135deg, #ec4899 0%, #f59e0b 50%, #10b981 100%);
            --ai-social: linear-gradient(135deg, #06b6d4 0%, #8b5cf6 50%, #ec4899 100%);
            --ai-habits: linear-gradient(135deg, #f59e0b 0%, #10b981 50%, #667eea 100%);
            --ai-learning: linear-gradient(135deg, #a855f7 0%, #06b6d4 50%, #00ffd4 100%);
            --ai-strategy: linear-gradient(135deg, #667eea 0%, #ec4899 50%, #f59e0b 100%);
            --ai-goals: linear-gradient(135deg, #00ffd4 0%, #10b981 50%, #8b5cf6 100%);
            --ai-conversation: linear-gradient(135deg, #00ffd4 0%, #667eea 50%, #a855f7 100%);
            --quantum-primary: linear-gradient(135deg, #8b5cf6 0%, #00ffd4 25%, #a855f7 50%, #667eea 75%, #ec4899 100%);
            --user-message: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            --ai-message: linear-gradient(135deg, #10b981 0%, #00ffd4 100%);
            
            --emotion-gradient: linear-gradient(135deg, #F472B6 0%, #EC4899 100%);
            --fusion-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --neural-gradient: linear-gradient(135deg, #667eea 0%, #8B5CF6 100%);
            --wearable-gradient: linear-gradient(135deg, #007AFF 0%, #2DD4BF 100%);
            
            --apple-blue: #007AFF; --fitbit-teal: #00B0B9; --garmin-blue: #007CC3;
            
            --bg: linear-gradient(135deg, #000000 0%, #0a0a14 25%, #12122b 50%, #1a1a2e 75%, #0f0f23 100%);
            --surface: rgba(15, 18, 45, 0.9); --glass-border: rgba(255, 255, 255, 0.15);
            --holographic: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
            
            --xs: 4px; --sm: 8px; --md: 16px; --lg: 24px; --xl: 32px;
            --border-radius: 14px; --border-radius-lg: 18px; --border-radius-2xl: 20px;
            --transition: all 0.45s cubic-bezier(0.23, 1, 0.32, 1);
            --mobile-safe-top: env(safe-area-inset-top); --mobile-safe-bottom: env(safe-area-inset-bottom);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg); color: var(--text-primary); min-height: 100vh;
            overflow-x: hidden; line-height: 1.5; -webkit-font-smoothing: antialiased;
        }

        /* App Container */
        .app-container {
            padding: calc(var(--mobile-safe-top) + 16px) 16px calc(100px + var(--mobile-safe-bottom) + 16px) 16px;
            max-width: 430px; margin: 0 auto; position: relative; min-height: calc(100vh - 120px);
        }

        /* Header */
        .app-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: var(--md) 0; margin-bottom: var(--lg);
        }

        .header-greeting { flex: 1; }

        .greeting-text {
            font-size: 1.5rem; font-weight: 800; margin-bottom: 4px;
            background: var(--ai-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .greeting-subtitle { font-size: 0.9rem; color: var(--text-muted); }

        .header-avatar {
            width: 48px; height: 48px; border-radius: 50%; background: var(--ai-primary);
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
            cursor: pointer; transition: var(--transition);
        }

        .header-avatar:hover { transform: scale(1.05); }

        /* Section Content */
        .section { display: none; animation: slideIn 0.4s ease; }
        .section.active { display: block; }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes quantumPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(139, 92, 246, 0.4); }
            33% { transform: scale(1.05); box-shadow: 0 0 30px rgba(0, 255, 212, 0.6); }
            66% { transform: scale(1.02); box-shadow: 0 0 25px rgba(168, 85, 247, 0.5); }
        }

        /* Cards */
        .card {
            background: var(--holographic); backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); border-radius: var(--border-radius-lg);
            padding: var(--lg); margin-bottom: var(--lg); position: relative; overflow: hidden;
        }

        .card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
            background: var(--ai-primary); background-size: 200% 200%;
            animation: shimmer 3s ease-in-out infinite;
        }

        .card.quantum::before { background: var(--quantum-primary); }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .card-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--lg);
        }

        .card-title {
            font-size: 1.1rem; font-weight: 700; display: flex; align-items: center; gap: var(--sm);
        }

        .card-action {
            background: rgba(255, 255, 255, 0.1); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--sm) var(--md);
            color: var(--text-primary); cursor: pointer; transition: var(--transition);
            font-size: 0.8rem; font-weight: 600;
        }

        .card-action:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-1px); }

        /* Sub Navigation */
        .sub-nav {
            display: flex; gap: var(--sm); margin-bottom: var(--lg); overflow-x: auto;
            padding: var(--sm) 0; scrollbar-width: none;
        }

        .sub-nav::-webkit-scrollbar { display: none; }

        .sub-nav-item {
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--glass-border);
            border-radius: 20px; padding: var(--sm) var(--md); white-space: nowrap;
            cursor: pointer; transition: var(--transition); font-size: 0.8rem;
            color: var(--text-secondary); flex-shrink: 0; font-weight: 600;
        }

        .sub-nav-item.active {
            background: var(--primary); color: white; border-color: var(--primary);
        }

        .sub-nav-item:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1); transform: translateY(-1px);
        }

        /* Quick Stats Grid */
        .quick-stats {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--md); margin-bottom: var(--lg);
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--md); text-align: center;
            transition: var(--transition); cursor: pointer;
        }

        .stat-item:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-2px); }

        .stat-value {
            font-size: 1.5rem; font-weight: 800; color: var(--text-primary); margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.75rem; color: var(--text-muted); font-weight: 600;
        }

        /* Feature Grid */
        .feature-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--md);
        }

        .feature-card {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--lg); cursor: pointer;
            transition: var(--transition); text-align: center;
        }

        .feature-card:hover { transform: translateY(-4px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3); }

        .feature-icon { font-size: 2rem; margin-bottom: var(--sm); }
        .feature-title { font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .feature-desc { font-size: 0.8rem; color: var(--text-muted); }

        /* Quick Actions */
        .quick-actions {
            display: flex; gap: var(--sm); margin-bottom: var(--md); overflow-x: auto;
            padding: var(--sm) 0; scrollbar-width: none;
        }

        .quick-actions::-webkit-scrollbar { display: none; }

        .quick-action {
            background: var(--holographic); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--sm) var(--md);
            white-space: nowrap; cursor: pointer; transition: var(--transition);
            font-size: 0.8rem; color: var(--text-secondary); flex-shrink: 0;
        }

        .quick-action:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-2px); }

        .quick-action.quantum {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(0, 255, 212, 0.1));
            border-color: rgba(139, 92, 246, 0.3);
        }

        .quick-action.quantum:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(0, 255, 212, 0.2));
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
        }

        /* AI Status and Conversation */
        .ai-status-bar {
            background: var(--ai-conversation); padding: var(--md); border-radius: var(--border-radius-lg);
            margin-bottom: var(--md); text-align: center; font-weight: 600;
            animation: pulse 2s ease-in-out infinite;
        }

        .ai-status-bar.listening { background: var(--ai-message); animation: breathe 1s ease-in-out infinite; }
        .ai-status-bar.quantum { background: var(--quantum-primary); animation: quantumPulse 3s ease-in-out infinite; }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .conversation-area {
            overflow-y: auto; padding: var(--md); background: var(--surface);
            border-radius: var(--border-radius-lg); margin-bottom: var(--md);
            border: 1px solid var(--glass-border); backdrop-filter: blur(25px);
            max-height: 300px; min-height: 200px;
        }

        .message { margin-bottom: var(--lg); animation: slideIn 0.3s ease; }
        .message.user { text-align: right; }
        .message.ai { text-align: left; }

        .message-bubble {
            display: inline-block; max-width: 85%; padding: var(--md); border-radius: var(--border-radius);
            font-size: 0.9rem; line-height: 1.4; position: relative; white-space: pre-wrap;
        }

        .message.user .message-bubble { background: var(--user-message); color: white; border-bottom-right-radius: 6px; }
        .message.ai .message-bubble { background: var(--ai-message); color: white; border-bottom-left-radius: 6px; }

        .message.ai .message-bubble.quantum {
            background: var(--quantum-primary); color: white; border-bottom-left-radius: 6px;
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
        }

        .message-time { font-size: 0.7rem; color: var(--text-muted); margin-top: 4px; }

        .input-container { display: flex; gap: var(--sm); align-items: flex-end; }
        .input-wrapper { flex: 1; position: relative; }

        .conversation-input {
            width: 100%; padding: var(--md); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg); background: var(--holographic);
            backdrop-filter: blur(25px); color: var(--text-primary); font-size: 0.9rem;
            resize: none; min-height: 44px; max-height: 120px;
        }

        .conversation-input:focus {
            outline: none; border-color: var(--primary);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .voice-button, .send-button {
            background: var(--ai-conversation); border: none; border-radius: 50%;
            width: 48px; height: 48px; color: white; font-size: 18px;
            cursor: pointer; transition: var(--transition); display: flex;
            align-items: center; justify-content: center; flex-shrink: 0;
        }

        .voice-button:hover, .send-button:hover {
            transform: scale(1.05); box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
        }

        .voice-button.listening { background: var(--error); animation: voicePulse 1s ease-in-out infinite; }

        @keyframes voicePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Context Panel Styles */
        .context-panel {
            background: var(--surface); border-radius: var(--border-radius); padding: var(--md);
            margin-bottom: var(--md); border: 1px solid var(--glass-border);
        }

        .context-title {
            font-weight: 700; margin-bottom: var(--sm); color: var(--secondary);
            font-size: 0.85rem;
        }

        .context-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 4px 0; font-size: 0.8rem; color: var(--text-secondary);
        }

        .context-value { color: var(--success); font-weight: 600; }

        /* Multi-Modal Input Panel */
        .multimodal-panel {
            background: var(--surface); border-radius: var(--border-radius); padding: var(--md);
            margin-bottom: var(--md); border: 1px solid var(--glass-border);
        }

        .multimodal-title {
            font-weight: 700; margin-bottom: var(--sm); color: var(--secondary);
            font-size: 0.85rem; display: flex; align-items: center; gap: var(--sm);
        }

        .multimodal-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sm);
        }

        .multimodal-action {
            background: var(--holographic); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--sm); cursor: pointer;
            transition: var(--transition); text-align: center; font-size: 0.8rem;
        }

        .multimodal-action:hover {
            background: rgba(255, 255, 255, 0.1); transform: translateY(-1px);
        }

        .multimodal-insight {
            background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius);
            padding: var(--sm); margin: var(--sm) 0; font-size: 0.75rem;
            color: var(--text-secondary); border-left: 3px solid var(--success);
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none; padding: var(--md); text-align: left;
        }

        .typing-indicator.active { display: block; }

        .typing-dots {
            display: inline-flex; gap: 4px; align-items: center;
            background: var(--surface); padding: var(--sm) var(--md); border-radius: var(--border-radius);
        }

        .typing-dot {
            width: 6px; height: 6px; border-radius: 50%; background: var(--text-muted);
            animation: typing 1.4s ease-in-out infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60% { opacity: 0.3; transform: scale(0.8); }
            30% { opacity: 1; transform: scale(1); }
        }

        /* Enhanced Engine Status */
        .engine-status-bar {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(168, 85, 247, 0.1));
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: var(--border-radius-lg);
            padding: var(--md);
            margin-bottom: var(--lg);
            position: relative;
            overflow: hidden;
        }

        .engine-status-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: engineScan 3s ease-in-out infinite;
        }

        .engine-status-bar.quantum {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(0, 255, 212, 0.1));
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .engine-status-bar.quantum::before {
            background: linear-gradient(90deg, transparent, rgba(0, 255, 212, 0.2), transparent);
        }

        @keyframes engineScan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Quantum Enhancement */
        .quantum-enhancement {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(0, 255, 212, 0.1));
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: var(--border-radius-lg);
            padding: var(--md);
            margin-bottom: var(--lg);
            position: relative;
        }

        .quantum-enhancement::before {
            content: '⚛️';
            position: absolute;
            top: var(--sm);
            right: var(--sm);
            font-size: 1.2rem;
            opacity: 0.7;
        }

        /* Integration Ecosystem */
        .integration-status {
            background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius);
            padding: var(--md); margin-bottom: var(--md); border-left: 3px solid var(--secondary);
        }

        .integration-insight {
            font-size: 0.85rem; color: var(--text-secondary); line-height: 1.4;
        }

        .integration-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sm);
            margin-bottom: var(--md);
        }

        .integration-item {
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--md); cursor: pointer;
            transition: var(--transition); display: flex; align-items: center; gap: var(--sm);
        }

        .integration-item:hover {
            background: rgba(255, 255, 255, 0.1); transform: translateY(-1px);
        }

        .integration-item.active {
            border-color: var(--success); background: rgba(16, 185, 129, 0.1);
        }

        .integration-icon {
            font-size: 1.2rem; width: 24px; text-align: center; flex-shrink: 0;
        }

        .integration-info { flex: 1; min-width: 0; }

        .integration-name {
            font-weight: 600; font-size: 0.8rem; color: var(--text-primary);
            margin-bottom: 2px;
        }

        .integration-desc { font-size: 0.7rem; color: var(--text-muted); }

        .integration-badge {
            color: var(--glass-border); font-size: 0.8rem; flex-shrink: 0;
        }

        .integration-badge.connected { color: var(--success); }

        .integration-metrics {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--sm);
            margin-bottom: var(--md); font-size: 0.75rem;
        }

        .metric-item {
            text-align: center; padding: var(--sm);
            background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius);
        }

        .metric-item .metric-label {
            display: block; color: var(--text-muted); margin-bottom: 2px;
        }

        .metric-item .metric-value {
            font-weight: 600; color: var(--text-primary);
        }

        /* Screen Time */
        .screen-time-chart {
            margin-bottom: var(--md);
        }

        .chart-header {
            display: flex; justify-content: space-between; margin-bottom: var(--sm);
            font-size: 0.8rem; color: var(--text-muted);
        }

        .screen-bars {
            display: flex; gap: 1px; height: 40px; 
            background: rgba(255,255,255,0.05); border-radius: 6px; overflow: hidden;
        }

        .screen-bar {
            flex: 1; min-width: 2px; background: var(--primary); 
            opacity: 0.7; transition: all 0.3s ease;
        }

        .screen-bar.productive { background: var(--success); opacity: 1; }
        .screen-bar.social { background: var(--warning); opacity: 0.8; }
        .screen-bar.distraction { background: var(--error); opacity: 0.6; }

        /* Morning/Evening Ritual */
        .morning-briefing, .evening-review {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--lg); margin-bottom: var(--lg);
        }

        .briefing-header, .review-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--md); font-weight: 600;
        }

        .energy-forecast {
            margin: var(--md) 0;
        }

        .forecast-chart {
            display: flex; gap: 2px; height: 40px; margin: var(--sm) 0;
            border-radius: 4px; overflow: hidden; background: rgba(255, 255, 255, 0.05);
        }

        .forecast-bar {
            flex: 1; min-width: 2px; transition: all 0.3s ease; background: var(--ai-productivity);
            opacity: 0.7; border-radius: 1px;
        }

        .forecast-bar.peak { opacity: 1; background: var(--success); }
        .forecast-bar.low { opacity: 0.4; background: var(--warning); }

        .action-list, .insights-list {
            display: flex; flex-direction: column; gap: var(--sm);
        }

        .action-item, .insight-item {
            display: flex; align-items: center; gap: var(--sm);
            padding: var(--sm); background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius); border-left: 3px solid var(--primary);
            font-size: 0.85rem; color: var(--text-secondary);
        }

        /* Biometric Grid */
        .biometric-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--md); margin: var(--lg) 0;
        }

        .biometric-card {
            border: 1px solid; border-radius: var(--border-radius); padding: var(--md); text-align: center;
        }

        .biometric-card.heart { background: rgba(255, 71, 87, 0.1); border-color: rgba(255, 71, 87, 0.3); }
        .biometric-card.oxygen { background: rgba(0, 212, 255, 0.1); border-color: rgba(0, 212, 255, 0.3); }
        .biometric-card.stress { background: rgba(168, 85, 247, 0.1); border-color: rgba(168, 85, 247, 0.3); }
        .biometric-card.hrv { background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); }

        .biometric-value {
            font-size: 1.8rem; font-weight: 800; margin-bottom: 4px;
        }

        .biometric-card.heart .biometric-value { color: #ff4757; }
        .biometric-card.oxygen .biometric-value { color: #00d4ff; }
        .biometric-card.stress .biometric-value { color: #a855f7; }
        .biometric-card.hrv .biometric-value { color: #10b981; }

        /* Morning Stack */
        .morning-stack {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--lg); margin-bottom: var(--lg);
        }

        .stack-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--md);
        }

        .stack-start-btn {
            background: var(--ai-health); border: none; border-radius: var(--border-radius);
            padding: var(--sm) var(--md); color: white; font-weight: 600;
            cursor: pointer; transition: var(--transition); font-size: 0.8rem;
        }

        .stack-start-btn:hover {
            transform: translateY(-1px); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .stack-sequence {
            display: flex; flex-direction: column; gap: var(--md);
        }

        .stack-item {
            display: flex; align-items: center; gap: var(--md);
            padding: var(--md); border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .stack-item.completed {
            background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success);
        }

        .stack-item.active {
            background: rgba(102, 126, 234, 0.1); border: 1px solid var(--primary);
            animation: pulse 2s ease-in-out infinite;
        }

        .stack-item.pending {
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--glass-border);
        }

        .stack-icon-circle {
            width: 40px; height: 40px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 1.2rem;
            background: var(--holographic); border: 1px solid var(--glass-border);
        }

        .stack-item.completed .stack-icon-circle {
            background: var(--success); color: white;
        }

        .stack-item.active .stack-icon-circle {
            background: var(--primary); color: white;
        }

        .stack-content {
            flex: 1;
        }

        .stack-name {
            font-weight: 600; color: var(--text-primary); margin-bottom: 2px;
        }

        .stack-duration {
            font-size: 0.8rem; color: var(--text-muted); margin-bottom: 2px;
        }

        .stack-progress {
            font-size: 0.8rem; font-weight: 600;
        }

        .stack-item.completed .stack-progress { color: var(--success); }
        .stack-item.active .stack-progress { color: var(--primary); }
        .stack-item.pending .stack-progress { color: var(--text-muted); }

        /* Energy Investment */
        .energy-investment {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--lg); margin-bottom: var(--lg);
        }

        .investment-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--md); font-weight: 600;
        }

        .energy-points { color: var(--warning); font-size: 0.85rem; }

        .investment-allocator {
            display: flex; flex-direction: column; gap: var(--md); margin-bottom: var(--lg);
        }

        .investment-category {
            display: flex; flex-direction: column; gap: var(--sm);
        }

        .category-info {
            display: flex; justify-content: space-between; align-items: center;
            font-size: 0.85rem;
        }

        .category-name { font-weight: 600; color: var(--text-primary); }
        .category-allocation { color: var(--warning); font-weight: 600; }

        .allocation-bar {
            height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px;
            overflow: hidden;
        }

        .allocation-fill {
            height: 100%; background: var(--ai-productivity); border-radius: 4px;
            transition: width 0.5s ease;
        }

        .optimize-allocation-btn {
            width: 100%; background: var(--ai-strategy); border: none;
            border-radius: var(--border-radius); padding: var(--md); color: white;
            font-weight: 600; cursor: pointer; transition: var(--transition);
        }

        .optimize-allocation-btn:hover {
            transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* Proactive AI */
        .proactive-panel {
            background: rgba(102, 126, 234, 0.1); border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: var(--border-radius); padding: var(--md); margin-bottom: var(--lg);
        }

        .proactive-title {
            font-weight: 700; margin-bottom: var(--sm); color: var(--primary);
        }

        .proactive-insight {
            font-size: 0.9rem; color: var(--text-secondary);
        }

        /* Gratitude Intelligence */
        .gratitude-intelligence {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--lg); margin-bottom: var(--lg);
        }

        .gratitude-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--md); font-weight: 600;
        }

        .gratitude-icon { font-size: 1.2rem; }
        .gratitude-title { flex: 1; margin: 0 var(--sm); }
        .gratitude-boost { color: var(--success); font-size: 0.85rem; }

        .gratitude-suggestions {
            display: flex; flex-direction: column; gap: var(--md);
            margin-bottom: var(--lg);
        }

        .gratitude-item {
            padding: var(--md); border-radius: var(--border-radius);
            background: rgba(255, 215, 0, 0.1); border-left: 3px solid var(--warning);
        }

        .gratitude-moment {
            font-weight: 600; color: var(--text-primary); margin-bottom: 4px;
            font-size: 0.9rem;
        }

        .gratitude-context {
            font-size: 0.8rem; color: var(--text-secondary); line-height: 1.4;
            font-style: italic;
        }

        /* Learning Recommendations */
        .learning-recommendations {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--lg); margin-bottom: var(--lg);
        }

        .learning-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--md); font-weight: 600;
        }

        .learning-icon { font-size: 1.2rem; }
        .learning-title { flex: 1; margin: 0 var(--sm); }
        .learning-match { color: var(--success); font-size: 0.85rem; }

        .learning-grid {
            display: flex; flex-direction: column; gap: var(--md);
        }

        .learning-item {
            display: flex; align-items: center; gap: var(--md);
            padding: var(--md); border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.05); transition: var(--transition);
            cursor: pointer;
        }

        .learning-item:hover {
            background: rgba(255, 255, 255, 0.1); transform: translateY(-1px);
        }

        .learning-type {
            font-size: 0.8rem; font-weight: 600; color: var(--secondary);
            background: rgba(102, 126, 234, 0.2); padding: 4px 8px;
            border-radius: 4px; flex-shrink: 0;
        }

        .learning-content {
            flex: 1;
        }

        .content-title {
            font-weight: 600; color: var(--text-primary); margin-bottom: 2px;
            font-size: 0.9rem;
        }

        .content-meta {
            font-size: 0.75rem; color: var(--text-muted);
        }

        .learning-score {
            font-weight: 700; color: var(--success); font-size: 0.9rem;
            flex-shrink: 0;
        }

        /* RPG/Gamification */
        .class-card {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg); padding: var(--lg); margin-bottom: var(--md);
            transition: var(--transition); cursor: pointer;
        }

        .class-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3); }

        .class-card.health-mage { border-left: 4px solid #ec4899; }
        .class-card.productivity-warrior { border-left: 4px solid #10b981; }
        .class-card.social-diplomat { border-left: 4px solid #06b6d4; }

        .class-header {
            display: flex; align-items: center; gap: var(--md); margin-bottom: var(--sm);
        }

        .class-icon { font-size: 2rem; width: 60px; text-align: center; }
        .class-info { flex: 1; }
        .class-name { font-size: 1.1rem; font-weight: 700; color: var(--text-primary); }
        .class-level { font-size: 0.9rem; color: var(--secondary); font-weight: 600; }

        .xp-bar {
            width: 100px; height: 6px; background: rgba(255, 255, 255, 0.1);
            border-radius: 3px; overflow: hidden;
        }

        .xp-progress {
            height: 100%; background: linear-gradient(90deg, var(--success), var(--secondary));
            border-radius: 3px; transition: width 1s ease;
        }

        .streak-card {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--md);
            display: flex; align-items: center; gap: var(--md);
            transition: var(--transition);
        }

        .streak-card.active-streak {
            border: 1px solid var(--success); background: rgba(16, 185, 129, 0.1);
            animation: streakGlow 2s ease-in-out infinite;
        }

        @keyframes streakGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
            50% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.6); }
        }

        /* Achievement Styles */
        .achievement-badge {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius); padding: var(--md);
            display: flex; align-items: center; gap: var(--md);
            transition: var(--transition); cursor: pointer; margin-bottom: var(--md);
        }

        .achievement-badge.unlocked {
            border-color: var(--success); background: rgba(16, 185, 129, 0.1);
        }

        .achievement-badge.unlocked:hover {
            transform: translateY(-2px); box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .achievement-badge.locked {
            opacity: 0.5; filter: grayscale(0.7);
        }

        .badge-icon {
            font-size: 1.5rem; width: 40px; text-align: center;
        }

        .badge-info {
            flex: 1;
        }

        .badge-name {
            font-weight: 600; color: var(--text-primary); margin-bottom: 2px;
        }

        .badge-desc {
            font-size: 0.8rem; color: var(--text-muted);
        }

        /* Phone Sensors Styles */
        .sensor-card {
            background: var(--holographic); backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); border-radius: var(--border-radius-lg);
            padding: var(--lg); margin-bottom: var(--lg); transition: var(--transition);
        }

        .sensor-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3); }

        .sensor-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: var(--md);
        }

        .sensor-title {
            display: flex; align-items: center; gap: var(--sm);
            font-size: 1.1rem; font-weight: 600;
        }

        .status-indicator {
            width: 8px; height: 8px; border-radius: 50%; background: var(--error);
            animation: pulse 2s infinite;
        }

        .status-indicator.connected { background: var(--success); }
        .status-indicator.connecting { background: var(--warning); }

        .sensor-data {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: var(--sm); margin: var(--md) 0;
        }

        .data-item {
            text-align: center; padding: var(--sm);
            background: rgba(255, 255, 255, 0.03); border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .data-value {
            font-size: 1.2rem; font-weight: 700; color: var(--primary);
            margin-bottom: 4px;
        }

        .data-label {
            font-size: 0.7rem; color: var(--text-muted);
            text-transform: uppercase; letter-spacing: 0.5px;
        }

        .chart-container {
            margin: var(--md) 0; padding: var(--md);
            background: rgba(0, 0, 0, 0.2); border-radius: var(--border-radius);
            height: 120px; position: relative; overflow: hidden;
        }

        .chart-canvas { width: 100%; height: 100%; }

        .audio-visualizer {
            height: 60px; background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius); margin: var(--md) 0;
            position: relative; overflow: hidden;
            display: flex; align-items: center; justify-content: center; gap: 2px;
        }

        .audio-bar {
            width: 3px; height: 15px; background: var(--secondary);
            border-radius: 2px; transition: height 0.1s ease;
        }

        .permission-notice, .sensor-info {
            background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: var(--border-radius); padding: var(--sm);
            margin: var(--md) 0; font-size: 0.8rem; color: var(--warning);
        }

        .sensor-info {
            background: rgba(6, 182, 212, 0.1); border-color: rgba(6, 182, 212, 0.3);
            color: var(--secondary);
        }

        .data-stream {
            max-height: 100px; overflow-y: auto;
            background: rgba(0, 0, 0, 0.3); border-radius: var(--border-radius);
            padding: var(--sm); margin: var(--md) 0;
            font-family: monospace; font-size: 0.7rem; line-height: 1.4;
        }

        .data-stream::-webkit-scrollbar { width: 3px; }
        .data-stream::-webkit-scrollbar-track { background: transparent; }
        .data-stream::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 2px; }

        .log-entry {
            margin-bottom: 3px; padding: 2px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .log-timestamp { color: var(--text-muted); font-size: 0.6rem; }

        /* Labs Overlay */
        .labs-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background: rgba(0, 0, 0, 0.95); backdrop-filter: blur(25px); 
            z-index: 400; opacity: 0; visibility: hidden;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            padding: calc(var(--mobile-safe-top) + 20px) 20px calc(var(--mobile-safe-bottom) + 20px) 20px;
        }

        .labs-overlay.active { opacity: 1; visibility: visible; }

        .labs-content {
            max-width: 500px; margin: 0 auto; height: 100%; 
            display: flex; flex-direction: column; color: var(--text-primary);
        }

        .labs-header {
            text-align: center; margin-bottom: var(--xl); position: relative;
        }

        .labs-title {
            font-size: 1.8rem; font-weight: 800; margin-bottom: var(--sm);
            background: var(--ai-learning); -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
        }

        .labs-subtitle {
            font-size: 1rem; color: var(--text-muted); font-weight: 500;
        }

        .labs-close {
            position: absolute; top: -10px; right: 0; background: none; 
            border: none; color: var(--text-muted); font-size: 2rem;
            cursor: pointer; transition: var(--transition); width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
        }

        .labs-close:hover { 
            color: var(--text-primary); background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1); 
        }

        .labs-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--lg); 
            margin-bottom: var(--xl); flex: 1; align-content: start;
        }

        .labs-overlay .lab-card {
            background: var(--surface); border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg); padding: var(--lg); text-align: center;
            cursor: pointer; transition: var(--transition); position: relative;
            height: 140px; display: flex; flex-direction: column; justify-content: center;
        }

        .labs-overlay .lab-card:hover {
            transform: translateY(-6px); 
            box-shadow: 0 12px 40px rgba(168, 85, 247, 0.3);
            border-color: var(--primary);
        }

        .labs-overlay .lab-card.active {
            border-color: var(--success); background: rgba(16, 185, 129, 0.1);
        }

        .labs-overlay .lab-card.quantum {
            border-color: var(--accent); background: rgba(168, 85, 247, 0.1);
            animation: quantumGlow 3s ease-in-out infinite;
        }

        .labs-overlay .lab-card.active::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
            background: var(--success); border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }

        .labs-overlay .lab-card.quantum::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
            background: var(--quantum-primary); border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }

        .labs-overlay .lab-icon {
            font-size: 2.2rem; margin-bottom: var(--sm);
        }

        .labs-overlay .lab-title {
            font-weight: 700; margin-bottom: 4px; font-size: 0.95rem;
        }

        .labs-overlay .lab-desc {
            font-size: 0.8rem; color: var(--text-muted); margin-bottom: var(--sm);
        }

        .lab-status {
            position: absolute; top: var(--sm); right: var(--sm);
            background: rgba(255, 255, 255, 0.1); border-radius: 12px;
            padding: 4px 8px; font-size: 0.7rem; font-weight: 600;
        }

        .lab-card.active .lab-status {
            background: var(--success); color: white;
        }

        .lab-card.quantum .lab-status {
            background: var(--quantum-primary); color: white;
        }

        .labs-stats {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--md);
            background: var(--surface); border-radius: var(--border-radius-lg);
            padding: var(--lg); border: 1px solid var(--glass-border);
        }

        .lab-stat {
            text-align: center;
        }

        .lab-stat .stat-value {
            font-size: 1.5rem; font-weight: 800; color: var(--primary);
            margin-bottom: 4px;
        }

        .lab-stat .stat-label {
            font-size: 0.75rem; color: var(--text-muted); font-weight: 600;
        }

        @keyframes quantumGlow {
            0%, 100% { border-color: rgba(168, 85, 247, 0.3); box-shadow: 0 0 10px rgba(168, 85, 247, 0.2); }
            50% { border-color: rgba(0, 255, 212, 0.6); box-shadow: 0 0 20px rgba(0, 255, 212, 0.3); }
        }

        /* Progress Rings */
        .progress-ring {
            position: relative; width: 80px; height: 80px; margin: 0 auto;
        }

        .progress-ring svg {
            width: 100%; height: 100%; transform: rotate(-90deg);
        }

        .progress-ring circle {
            fill: none; stroke-width: 4; stroke-linecap: round;
        }

        .progress-ring .bg { stroke: rgba(255, 255, 255, 0.1); }

        .progress-ring .progress {
            stroke: var(--primary); stroke-dasharray: 251; stroke-dashoffset: 251;
            transition: stroke-dashoffset 1s ease-in-out;
        }

        .progress-text {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 0.9rem; font-weight: 700; color: var(--text-primary);
        }

        /* Emotional Fusion Engine Styles */
        .emotion-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .emotion-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .emotion-emoji {
            font-size: 2rem;
            display: block;
            margin-bottom: 8px;
        }

        .emotion-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .emotion-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .correlation-indicator {
            font-size: 0.8rem;
            color: var(--secondary);
            margin-top: 4px;
        }

        .biometric-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .biometric-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .biometric-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .fusion-status {
            background: var(--fusion-gradient);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .correlation-matrix {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .correlation-cell {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .correlation-value {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .correlation-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .video-container {
            position: relative;
            margin: 15px 0;
            text-align: center;
        }

        video {
            width: 100%;
            max-width: 300px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .canvas-overlay {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 12px;
            pointer-events: none;
        }

        .log-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.85rem;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }

        .log-entry.success {
            color: var(--success);
        }

        .log-entry.error {
            color: var(--error);
        }

        .log-entry.info {
            color: var(--info);
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            height: 8px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 1s ease;
            border-radius: 8px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .status-active {
            background: var(--success);
            animation: pulse 2s infinite;
        }

        .status-inactive {
            background: var(--error);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0;
            height: calc(84px + var(--mobile-safe-bottom)); background: var(--holographic);
            backdrop-filter: blur(30px); border: 1px solid var(--glass-border);
            border-radius: 20px 20px 0 0; z-index: 100;
            padding: var(--md) var(--md) calc(var(--md) + var(--mobile-safe-bottom)) var(--md);
        }

        .nav-items {
            display: flex; justify-content: space-around; align-items: center; height: 52px;
        }

        .nav-item {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: var(--xs); border-radius: var(--border-radius); cursor: pointer;
            transition: var(--transition); flex: 1; max-width: 80px;
        }

        .nav-item.active {
            background: rgba(102, 126, 234, 0.2); color: var(--primary);
            transform: scale(1.05);
        }

        .nav-icon {
            font-size: 1.3rem; margin-bottom: 2px; transition: var(--transition);
        }

        .nav-label {
            font-size: 0.65rem; font-weight: 700; line-height: 1; text-align: center;
        }

        .nav-item:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05); transform: translateY(-1px);
        }

        /* Notification */
        .notification {
            position: fixed; top: calc(20px + var(--mobile-safe-top)); left: 16px; right: 16px;
            background: rgba(10, 10, 20, 0.95); backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 16px;
            padding: 16px 20px; color: white; z-index: 1100; font-weight: 600;
            transform: translateY(-100px); transition: transform 0.4s ease;
            max-width: 430px; margin: 0 auto; font-size: 0.9rem;
        }

        .notification.show { transform: translateY(0); }
        .notification.success { border-left: 4px solid var(--success); }
        .notification.info { border-left: 4px solid var(--info); }
        .notification.warning { border-left: 4px solid var(--warning); }
        .notification.error { border-left: 4px solid var(--error); }
        .notification.quantum { border-left: 4px solid var(--accent); background: rgba(139, 92, 246, 0.1); }

        /* Sensors Overlay */
        .sensors-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background: rgba(0, 0, 0, 0.95); backdrop-filter: blur(25px); 
            z-index: 400; opacity: 0; visibility: hidden;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            padding: calc(var(--mobile-safe-top) + 20px) 20px calc(var(--mobile-safe-bottom) + 20px) 20px;
            overflow-y: auto;
        }

        .sensors-overlay.active { opacity: 1; visibility: visible; }

        .sensors-content {
            max-width: 500px; margin: 0 auto; color: var(--text-primary);
        }

        .sensors-header {
            text-align: center; margin-bottom: var(--xl); position: relative;
        }

        .sensors-title {
            font-size: 1.8rem; font-weight: 800; margin-bottom: var(--sm);
            background: var(--ai-health); -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
        }

        .sensors-subtitle {
            font-size: 1rem; color: var(--text-muted); font-weight: 500;
        }

        .sensors-close {
            position: absolute; top: -10px; right: 0; background: none; 
            border: none; color: var(--text-muted); font-size: 2rem;
            cursor: pointer; transition: var(--transition); width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
        }

        .sensors-close:hover { 
            color: var(--text-primary); background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1); 
        }

        /* Responsive */
        @media (max-width: 768px) {
            .quick-stats { grid-template-columns: repeat(2, 1fr); }
            .feature-grid { grid-template-columns: 1fr; }
            .biometric-grid { grid-template-columns: 1fr; }
            .integration-grid { grid-template-columns: 1fr; }
            .correlation-matrix { grid-template-columns: repeat(2, 1fr); }
            
            .labs-grid { grid-template-columns: 1fr; }
            .labs-content { padding: 0; }
            .labs-overlay .lab-card { height: 120px; }
            .labs-title { font-size: 1.5rem; }
        }

        .hidden { display: none; }

        .grid-2 {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--md);
        }

        .grid-3 {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--md);
        }

        .btn {
            background: var(--primary); border: none; border-radius: var(--border-radius);
            padding: var(--md); color: white; font-weight: 600;
            cursor: pointer; transition: var(--transition); font-size: 0.8rem;
            display: flex; align-items: center; justify-content: center; gap: var(--sm);
        }

        .btn:hover {
            transform: translateY(-1px); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn.conversation {
            background: var(--ai-conversation);
        }

        .btn.quantum {
            background: var(--quantum-primary);
        }

        .btn.quantum:hover {
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.6);
        }

        .btn.emotion {
            background: var(--emotion-gradient);
        }

        .btn.fusion {
            background: var(--fusion-gradient);
        }

        .btn.neural {
            background: var(--neural-gradient);
        }

        .btn.wearable {
            background: var(--wearable-gradient);
        }

        .btn.stop {
            background: linear-gradient(135deg, var(--error), #dc2626);
        }

        .btn:disabled {
            opacity: 0.5; cursor: not-allowed; transform: none;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="app-header">
            <div class="header-greeting">
                <div class="greeting-text">Good morning, Belinda</div>
                <div class="greeting-subtitle">Quantum-enhanced optimization ready</div>
            </div>
            <div class="header-avatar" onclick="switchSection('profile')">🧠</div>
        </div>

        <!-- AI Coach Section with Enhanced Conversation Interface -->
        <div class="section ai-coach active" id="aiCoach">
            <!-- AI Status Card with Integrated Conversation -->
            <div class="card quantum">
                <div class="card-header">
                    <div class="card-title">
                        <span>🤖</span>
                        <span>Quantum-Enhanced AI Life Coach</span>
                    </div>
                    <div class="card-action" onclick="startFullConversation()">Expand</div>
                </div>

                <!-- AI Status Bar -->
                <div class="ai-status-bar quantum" id="aiStatus">
                    ⚛️ Quantum Intelligence Layer Active
                </div>

                <!-- Context Panel -->
                <div class="context-panel">
                    <div class="context-title">📊 Current Context</div>
                    <div class="context-item">
                        <span>Energy Level</span>
                        <span class="context-value" id="contextEnergy">82%</span>
                    </div>
                    <div class="context-item">
                        <span>Mood</span>
                        <span class="context-value" id="contextMood">Focused</span>
                    </div>
                    <div class="context-item">
                        <span>Current Goal</span>
                        <span class="context-value" id="contextGoal">Productivity</span>
                    </div>
                    <div class="context-item">
                        <span>Personality Type</span>
                        <span class="context-value" id="contextPersonality">Analytical-Achiever</span>
                    </div>
                    <div class="context-item">
                        <span>Quantum Coherence</span>
                        <span class="context-value" id="contextQuantumCoherence">87%</span>
                    </div>
                    <div class="context-item">
                        <span>Optimization Score</span>
                        <span class="context-value" id="contextOptimizationScore">91%</span>
                    </div>
                </div>

                <!-- Enhanced Engine Status Panel -->
                <div class="engine-status-bar quantum">
                    <div style="font-weight: 700; margin-bottom: var(--sm); color: var(--accent); font-size: 0.85rem;">⚛️ Quantum AI Engines Status</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sm); font-size: 0.75rem;">
                        <div style="color: var(--text-secondary);">🎮 Gamification: <span style="color: var(--success); font-weight: 600;">Active</span></div>
                        <div style="color: var(--text-secondary);">🛡️ Interventions: <span style="color: var(--success); font-weight: 600;">Monitoring</span></div>
                        <div style="color: var(--text-secondary);">🎭 Personalization: <span style="color: var(--success); font-weight: 600;">Learning</span></div>
                        <div style="color: var(--text-secondary);">🧠 Patterns: <span style="color: var(--success); font-weight: 600;">Analyzing</span></div>
                        <div style="color: var(--text-secondary);">⚛️ Quantum Annealing: <span style="color: var(--accent); font-weight: 600;">Optimizing</span></div>
                        <div style="color: var(--text-secondary);">💫 Superposition: <span style="color: var(--accent); font-weight: 600;">Processing</span></div>
                        <div style="color: var(--text-secondary);">🎯 Domain Optimizers: <span style="color: var(--accent); font-weight: 600;">Active</span></div>
                        <div style="color: var(--text-secondary);">📊 Coherence Tracker: <span style="color: var(--accent); font-weight: 600;">Monitoring</span></div>
                    </div>
                </div>

                <!-- Quantum Enhancement Display -->
                <div class="quantum-enhancement">
                    <div style="font-weight: 700; margin-bottom: var(--sm); color: var(--accent); font-size: 0.85rem;">⚛️ Quantum Intelligence Enhancement</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sm); font-size: 0.75rem;">
                        <div style="color: var(--text-secondary);">Coherence Level: <span style="color: var(--secondary); font-weight: 600;" id="quantumCoherenceDisplay">87.3%</span></div>
                        <div style="color: var(--text-secondary);">Optimization Score: <span style="color: var(--secondary); font-weight: 600;" id="quantumOptimizationDisplay">91.2%</span></div>
                        <div style="color: var(--text-secondary);">Parallel Pathways: <span style="color: var(--warning); font-weight: 600;" id="quantumPathwaysDisplay">5</span></div>
                        <div style="color: var(--text-secondary);">Performance State: <span style="color: var(--success); font-weight: 600;" id="quantumPerformanceDisplay">Peak</span></div>
                        <div style="color: var(--text-secondary);">Domain Coherence: <span style="color: var(--secondary); font-weight: 600;" id="domainCoherenceDisplay">89.1%</span></div>
                        <div style="color: var(--text-secondary);">Active Optimizers: <span style="color: var(--warning); font-weight: 600;" id="activeOptimizersDisplay">6</span></div>
                    </div>
                </div>

                <!-- Conversation Area -->
                <div class="conversation-area" id="conversationArea">
                    <div class="message ai">
                        <div class="message-bubble quantum">
                            Hi! I'm your Quantum-Enhanced AI Life Coach with advanced parallel processing and optimization algorithms. I can help you with productivity, health, emotions, goals, and more using quantum intelligence. What would you like to work on today?
                        </div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>

                <!-- Typing Indicator -->
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                    <span style="margin-left: 8px; font-size: 0.8rem; color: var(--text-muted);">Quantum AI is processing...</span>
                </div>

                <!-- Input Container -->
                <div class="input-container">
                    <button class="voice-button" id="voiceButton" onclick="toggleVoiceInput()">
                        🎤
                    </button>
                    <div class="input-wrapper">
                        <textarea 
                            class="conversation-input" 
                            id="messageInput" 
                            placeholder="Ask your quantum AI coach anything..."
                            rows="1"
                            onkeydown="handleInputKeyDown(event)"
                            oninput="adjustTextareaHeight(this)"
                        ></textarea>
                    </div>
                    <button class="send-button" id="sendButton" onclick="sendMessage()">
                        ➤
                    </button>
                </div>

                <!-- Multi-Modal Input Panel -->
                <div class="multimodal-panel">
                    <div class="multimodal-title">
                        ⚛️ Quantum Multi-Modal Intelligence
                    </div>
                    <div class="multimodal-grid">
                        <div class="multimodal-action" onclick="startVoiceJournal()">
                            🎙️ Voice Journal
                        </div>
                        <div class="multimodal-action" onclick="startCameraMood()">
                            📷 Mood Scan
                        </div>
                        <div class="multimodal-action" onclick="analyzeScreenTime()">
                            📱 Screen Analysis
                        </div>
                        <div class="multimodal-action" onclick="uploadPhoto()">
                            📸 Photo Log
                        </div>
                    </div>
                    <div class="multimodal-insight" id="multimodalInsight" style="display: none;">
                        ⚛️ Quantum multi-modal analysis ready
                    </div>
                </div>

                <!-- Daily Insights -->
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-value">91%</div>
                        <div class="stat-label">Energy Forecast</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">3</div>
                        <div class="stat-label">Priority Actions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">2:17</div>
                        <div class="stat-label">Next Energy Dip</div>
                    </div>
                </div>

                <!-- Proactive AI Intervention Panel -->
                <div class="proactive-panel">
                    <div class="proactive-title">⚛️ Quantum AI Insight</div>
                    <div class="proactive-insight" id="proactiveInsight">Quantum optimization reveals 23% efficiency gain possible with timing adjustments.</div>
                </div>

                <!-- Smart Recommendations -->
                <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); margin-bottom: var(--lg);">
                    <div style="font-size: 0.85rem; font-weight: 600; margin-bottom: var(--sm); color: var(--secondary);">⚛️ Quantum Personalization</div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);" id="personalizationStatus">Quantum entanglement patterns suggest optimal learning window in 15 minutes</div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <div class="quick-action quantum" onclick="sendQuickMessage('Show me quantum-optimized daily briefing with parallel pathway analysis')">
                        ⚛️ Quantum Briefing
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Generate my daily AI briefing with energy forecast')">
                        🌅 Daily Briefing
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('Activate quantum superposition analysis for decision optimization')">
                        💫 Superposition Analysis
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Start my personalized morning optimization ritual')">
                        🧬 Morning Ritual
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('Show quantum entanglement patterns between my life domains')">
                        🔗 Quantum Entanglement
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Help me reflect on today and optimize for tomorrow')">
                        🌙 Evening Reflection
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('Run quantum annealing optimization on my current goals')">
                        🎯 Quantum Goals
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('How can I boost my energy?')">
                        ⚡ Energy Boost
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Optimize my energy allocation for today')">
                        🎯 Energy Plan
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('What quantum-optimized obstacles should I prepare for?')">
                        🛡️ Quantum Prep
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Show me my integration insights and cross-platform patterns')">
                        🔗 Integrations
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Analyze my current biometric data and give me health insights')">
                        📱 Biometric Analysis
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Show me the correlation between my emotions and biometric data')">
                        🧠💓 Emotional-Biometric Fusion
                    </div>
                    <div class="quick-action" onclick="startBiometricMonitoring()">
                        ❤️ Start Monitoring
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('Show quantum coherence optimization for stress management')">
                        🧘 Quantum Stress
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('What is my personality type and how do you adapt to it?')">
                        🎭 Personality
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('Activate quantum behavioral pattern recognition across all life domains')">
                        🔍 Quantum Patterns
                    </div>
                    <div class="quick-action" onclick="sendQuickMessage('Analyze my hardware sensor data and phone interaction patterns')">
                        📱 Hardware Analysis
                    </div>
                    <div class="quick-action quantum" onclick="sendQuickMessage('Generate quantum-enhanced predictive insights for optimal performance')">
                        🔮 Quantum Predictions
                    </div>
                    <div class="quick-action" onclick="toggleLabs()">
                        ⚛️ Quantum Labs
                    </div>
                    <div class="quick-action" onclick="startCameraPPGMonitoring()">
                        📷 Camera PPG
                    </div>
                    <div class="quick-action" onclick="adaptToPersonality()">
                        🎭 Personality Adapt
                    </div>
                    <div class="quick-action" onclick="checkAchievements()">
                        🎮 Check Achievements
                    </div>
                    <div class="quick-action" onclick="viewInterventionStats()">
                        🛡️ Intervention Stats
                    </div>
                    <div class="quick-action" onclick="triggerLearningActivity()">
                        📚 Learning XP
                    </div>
                </div>
            </div>

            <!-- Screen Time Visualization -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>📱</span>
                        <span>Screen Time Intelligence</span>
                    </div>
                    <div style="color: var(--success); font-size: 0.8rem; font-weight: 600;">68% Productive</div>
                </div>
                        
                <div class="screen-time-chart" id="screenTimeChart">
                    <div class="chart-header">
                        <span>6 AM</span>
                        <span>12 PM</span>
                        <span>6 PM</span>
                        <span>12 AM</span>
                    </div>
                    <div class="screen-bars" id="screenBars">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--sm); margin-top: var(--md);">
                        <div style="text-align: center; font-size: 0.75rem;">
                            <div style="color: var(--success); font-weight: 600;">4.2h</div>
                            <div style="color: var(--text-muted);">Productive</div>
                        </div>
                        <div style="text-align: center; font-size: 0.75rem;">
                            <div style="color: var(--warning); font-weight: 600;">1.8h</div>
                            <div style="color: var(--text-muted);">Social</div>
                        </div>
                        <div style="text-align: center; font-size: 0.75rem;">
                            <div style="color: var(--error); font-weight: 600;">0.3h</div>
                            <div style="color: var(--text-muted);">Distraction</div>
                        </div>
                    </div>
                </div>

                <div class="feature-grid" style="margin-top: var(--lg);">
                    <div class="feature-card" onclick="startFocusSession()">
                        <div class="feature-icon">🎯</div>
                        <div class="feature-title">Focus Session</div>
                        <div class="feature-desc">Start deep work</div>
                    </div>
                    <div class="feature-card" onclick="analyzeScreenTime()">
                        <div class="feature-icon">📱</div>
                        <div class="feature-title">Screen Intelligence</div>
                        <div class="feature-desc">68% productive time</div>
                    </div>
                    <div class="feature-card" onclick="toggleLabs()">
                        <div class="feature-icon">⚛️</div>
                        <div class="feature-title">Quantum Labs</div>
                        <div class="feature-desc">Advanced analysis</div>
                    </div>
                    <div class="feature-card" onclick="obstacleAnticipation()">
                        <div class="feature-icon">🛡️</div>
                        <div class="feature-title">Obstacle Prep</div>
                        <div class="feature-desc">91% accuracy</div>
                    </div>
                </div>
            </div>

            <!-- Integration Ecosystem -->
            <div class="card">
                <div class="card-title">🔗 Integration Ecosystem</div>
                
                <div class="integration-status">
                    <div class="integration-insight" id="integrationInsight">
                        🔗 Calendar optimization • Email sentiment tracking • Smart environment ready
                    </div>
                </div>
                
                <div class="integration-grid">
                    <div class="integration-item active" onclick="toggleIntegration('calendar')">
                        <div class="integration-icon">📅</div>
                        <div class="integration-info">
                            <div class="integration-name">Calendar Intelligence</div>
                            <div class="integration-desc">Energy-based scheduling</div>
                        </div>
                        <div class="integration-badge connected">●</div>
                    </div>
                    
                    <div class="integration-item active" onclick="toggleIntegration('email')">
                        <div class="integration-icon">📧</div>
                        <div class="integration-info">
                            <div class="integration-name">Email Sentiment</div>
                            <div class="integration-desc">Communication analysis</div>
                        </div>
                        <div class="integration-badge connected">●</div>
                    </div>
                    
                    <div class="integration-item active" onclick="toggleIntegration('biometric')">
                        <div class="integration-icon">📱</div>
                        <div class="integration-info">
                            <div class="integration-name">Biometric Monitoring</div>
                            <div class="integration-desc">Real-time health tracking</div>
                        </div>
                        <div class="integration-badge connected">●</div>
                    </div>
                    
                    <div class="integration-item" onclick="toggleIntegration('smarthome')">
                        <div class="integration-icon">🏠</div>
                        <div class="integration-info">
                            <div class="integration-name">Smart Home</div>
                            <div class="integration-desc">Environment optimization</div>
                        </div>
                        <div class="integration-badge">●</div>
                    </div>
                    
                    <div class="integration-item" onclick="toggleIntegration('financial')">
                        <div class="integration-icon">💰</div>
                        <div class="integration-info">
                            <div class="integration-name">Financial Wellness</div>
                            <div class="integration-desc">Spending & mood correlation</div>
                        </div>
                        <div class="integration-badge">●</div>
                    </div>
                    
                    <div class="integration-item" onclick="toggleIntegration('wearables')">
                        <div class="integration-icon">⌚</div>
                        <div class="integration-info">
                            <div class="integration-name">Wearable Devices</div>
                            <div class="integration-desc">Watch & fitness tracker sync</div>
                        </div>
                        <div class="integration-badge">●</div>
                    </div>
                </div>
                
                <div class="integration-metrics">
                    <div class="metric-item">
                        <span class="metric-label">Connected Platforms</span>
                        <span class="metric-value" id="connectedPlatforms">3/6</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Time Saved This Week</span>
                        <span class="metric-value" id="timeSavedWeek">127 min</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Cross-Platform Insights</span>
                        <span class="metric-value" id="crossPlatformCount">4</span>
                    </div>
                </div>
                
                <div class="grid-2">
                    <button class="btn conversation" onclick="sendQuickMessage('Show me my integration insights and cross-platform patterns')">
                        <span>💬</span><span>Ask AI Coach</span>
                    </button>
                    <button class="btn quantum" onclick="runQuantumIntegrationAnalysis()" style="background: linear-gradient(135deg, #667eea 0%, #00ffd4 50%, #a855f7 100%);">
                        <span>⚛️</span><span>Quantum Analysis</span>
                    </button>
                </div>
            </div>

            <!-- Morning Optimization Ritual -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>🌅</span>
                        <span>Morning Optimization Ritual</span>
                    </div>
                    <div class="card-action" onclick="startMorningRitual()">Start</div>
                </div>

                <!-- Energy Forecast -->
                <div class="energy-forecast">
                    <div style="font-weight: 600; margin-bottom: var(--sm); color: var(--secondary); font-size: 0.85rem;">⚡ Energy Forecast</div>
                    <div class="forecast-chart" id="energyForecast">
                        <!-- Energy bars will be generated by JavaScript -->
                    </div>
                    <div style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin-top: 4px;">
                        Peak: 9:00-11:00 AM | Dip: 2:17 PM
                    </div>
                </div>

                <!-- Priority Actions -->
                <div style="margin-top: var(--lg);">
                    <div style="font-weight: 600; margin-bottom: var(--sm); color: var(--secondary); font-size: 0.85rem;">🎯 Top 3 Priority Actions</div>
                    <div class="action-list">
                        <div class="action-item">
                            <span style="font-size: 1rem;">🔥</span>
                            <span>Deep work session: Project Alpha (peak energy window)</span>
                        </div>
                        <div class="action-item">
                            <span style="font-size: 1rem;">💧</span>
                            <span>Hydrate before 2 PM energy dip (preventive intervention)</span>
                        </div>
                        <div class="action-item">
                            <span style="font-size: 1rem;">🤝</span>
                            <span>Team meeting: Use afternoon social energy optimally</span>
                        </div>
                    </div>
                </div>

                <!-- Personalized Morning Stack -->
                <div class="morning-stack">
                    <div class="stack-header">
                        <span style="font-size: 1.2rem;">🧬</span>
                        <span style="flex: 1; margin: 0 var(--sm); font-weight: 600;">Your Personalized Morning Stack</span>
                        <button class="stack-start-btn" onclick="startPersonalizedStack()">▶️ Start Stack</button>
                    </div>
                    <div class="stack-sequence" id="morningSequence">
                        <div class="stack-item completed">
                            <div class="stack-icon-circle">🧘</div>
                            <div class="stack-content">
                                <div class="stack-name">Meditation</div>
                                <div class="stack-duration">7 min • Analytical Style</div>
                                <div class="stack-progress">✅ Completed</div>
                            </div>
                        </div>
                        <div class="stack-item active">
                            <div class="stack-icon-circle">🏃</div>
                            <div class="stack-content">
                                <div class="stack-name">Movement</div>
                                <div class="stack-duration">12 min • High-Intensity</div>
                                <div class="stack-progress">In Progress (8/12 min)</div>
                            </div>
                        </div>
                        <div class="stack-item pending">
                            <div class="stack-icon-circle">🥗</div>
                            <div class="stack-content">
                                <div class="stack-name">Nutrition</div>
                                <div class="stack-duration">Protein-rich breakfast</div>
                                <div class="stack-progress">Optimized for your metabolism</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Energy Investment Planning -->
                <div class="energy-investment">
                    <div class="investment-header">
                        <span style="font-size: 1.2rem;">⚡</span>
                        <span style="flex: 1; margin: 0 var(--sm);">Energy Investment Plan</span>
                        <span class="energy-points">100 Energy Points Available</span>
                    </div>
                    <div class="investment-allocator" id="energyAllocator">
                        <div class="investment-category">
                            <div class="category-info">
                                <span class="category-name">🎯 Deep Work</span>
                                <span class="category-allocation">45 points</span>
                            </div>
                            <div class="allocation-bar">
                                <div class="allocation-fill" style="width: 45%;"></div>
                            </div>
                        </div>
                        <div class="investment-category">
                            <div class="category-info">
                                <span class="category-name">🤝 Social/Meetings</span>
                                <span class="category-allocation">25 points</span>
                            </div>
                            <div class="allocation-bar">
                                <div class="allocation-fill" style="width: 25%;"></div>
                            </div>
                        </div>
                        <div class="investment-category">
                            <div class="category-info">
                                <span class="category-name">📚 Learning</span>
                                <span class="category-allocation">20 points</span>
                            </div>
                            <div class="allocation-bar">
                                <div class="allocation-fill" style="width: 20%;"></div>
                            </div>
                        </div>
                        <div class="investment-category">
                            <div class="category-info">
                                <span class="category-name">🔧 Admin Tasks</span>
                                <span class="category-allocation">10 points</span>
                            </div>
                            <div class="allocation-bar">
                                <div class="allocation-fill" style="width: 10%;"></div>
                            </div>
                        </div>
                    </div>
                    <button class="optimize-allocation-btn" onclick="optimizeEnergyAllocation()">
                        ⚛️ Quantum Optimize Allocation
                    </button>
                </div>
            </div>

            <!-- Evening Reflection & Learning -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>🌙</span>
                        <span>Evening Reflection & Learning</span>
                    </div>
                    <div class="card-action" onclick="triggerEveningReflection()">Start</div>
                </div>

                <!-- Today's Insights -->
                <div style="margin-bottom: var(--lg);">
                    <div style="font-weight: 600; margin-bottom: var(--sm); color: var(--secondary); font-size: 0.85rem;">🤖 Today's AI-Extracted Insights</div>
                    <div class="insights-list">
                        <div class="insight-item">✨ Your energy peaked at 9:23 AM - optimal timing for tomorrow's important work</div>
                        <div class="insight-item">🎯 Completed 87% of planned tasks - exceeded your 80% average</div>
                        <div class="insight-item">💬 3 meaningful conversations deepened your social connections</div>
                    </div>
                </div>

                <!-- Learning Recommendations -->
                <div class="learning-recommendations">
                    <div class="learning-header">
                        <span class="learning-icon">📚</span>
                        <span class="learning-title">Personalized Learning</span>
                        <span class="learning-match">94% Goal Match</span>
                    </div>
                    <div class="learning-grid" id="learningGrid">
                        <div class="learning-item">
                            <div class="learning-type">🎥 Video</div>
                            <div class="learning-content">
                                <div class="content-title">Advanced Time Management for Analytical Minds</div>
                                <div class="content-meta">12 min • Productivity • Perfect for your profile</div>
                            </div>
                            <div class="learning-score">97%</div>
                        </div>
                        <div class="learning-item">
                            <div class="learning-type">📖 Article</div>
                            <div class="learning-content">
                                <div class="content-title">Energy Optimization Techniques</div>
                                <div class="content-meta">8 min read • Health • Based on your energy patterns</div>
                            </div>
                            <div class="learning-score">89%</div>
                        </div>
                        <div class="learning-item">
                            <div class="learning-type">🎧 Podcast</div>
                            <div class="learning-content">
                                <div class="content-title">Social Intelligence in Professional Settings</div>
                                <div class="content-meta">23 min • Social • Matches your diplomat class</div>
                            </div>
                            <div class="learning-score">91%</div>
                        </div>
                    </div>
                </div>

                <!-- Gratitude Intelligence -->
                <div class="gratitude-intelligence">
                    <div class="gratitude-header">
                        <span class="gratitude-icon">🙏</span>
                        <span class="gratitude-title">Gratitude Intelligence</span>
                        <span class="gratitude-boost">+15% Well-being</span>
                    </div>
                    <div class="gratitude-suggestions" id="gratitudeSuggestions">
                        <div class="gratitude-item">
                            <div class="gratitude-moment">💼 Your 9:45 AM breakthrough on the project challenge</div>
                            <div class="gratitude-context">AI detected elevated satisfaction and energy during this moment</div>
                        </div>
                        <div class="gratitude-item">
                            <div class="gratitude-moment">🤝 The supportive message from Sarah at 2:17 PM</div>
                            <div class="gratitude-context">Communication analysis shows this boosted your afternoon mood</div>
                        </div>
                        <div class="gratitude-item">
                            <div class="gratitude-moment">🌱 Your consistent morning routine creating stability</div>
                            <div class="gratitude-context">Pattern analysis reveals this anchors your daily success</div>
                        </div>
                    </div>
                </div>

                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">📚</div>
                        <div class="feature-title">Learning Plan</div>
                        <div class="feature-desc">94% goal match</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🙏</div>
                        <div class="feature-title">Gratitude AI</div>
                        <div class="feature-desc">+15% well-being</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Emotional Fusion Engine Section -->
        <div class="section" id="emotionalFusion">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>🧠💓</span>
                        <span>Emotional Fusion Engine</span>
                    </div>
                    <div class="fusion-status">
                        <span class="status-indicator status-active"></span>
                        FUSION ACTIVE
                    </div>
                </div>

                <!-- Real-time Emotional State -->
                <div style="margin-bottom: var(--lg);">
                    <h3 style="margin-bottom: var(--md); color: var(--secondary);">😊 Real-time Emotional Analysis</h3>
                    
                    <div class="grid-3" id="emotionGrid">
                        <div class="emotion-item" data-emotion="happy">
                            <span class="emotion-emoji">😊</span>
                            <div class="emotion-label">Happy</div>
                            <div class="emotion-value" id="happy">0%</div>
                            <div class="correlation-indicator" id="happyCorr">HR: --</div>
                        </div>
                        <div class="emotion-item" data-emotion="sad">
                            <span class="emotion-emoji">😢</span>
                            <div class="emotion-label">Sad</div>
                            <div class="emotion-value" id="sad">0%</div>
                            <div class="correlation-indicator" id="sadCorr">HR: --</div>
                        </div>
                        <div class="emotion-item" data-emotion="angry">
                            <span class="emotion-emoji">😠</span>
                            <div class="emotion-label">Angry</div>
                            <div class="emotion-value" id="angry">0%</div>
                            <div class="correlation-indicator" id="angryCorr">HR: --</div>
                        </div>
                        <div class="emotion-item" data-emotion="fearful">
                            <span class="emotion-emoji">😨</span>
                            <div class="emotion-label">Fearful</div>
                            <div class="emotion-value" id="fearful">0%</div>
                            <div class="correlation-indicator" id="fearfulCorr">HR: --</div>
                        </div>
                        <div class="emotion-item" data-emotion="surprised">
                            <span class="emotion-emoji">😮</span>
                            <div class="emotion-label">Surprised</div>
                            <div class="emotion-value" id="surprised">0%</div>
                            <div class="correlation-indicator" id="surprisedCorr">HR: --</div>
                        </div>
                        <div class="emotion-item" data-emotion="neutral">
                            <span class="emotion-emoji">😐</span>
                            <div class="emotion-label">Neutral</div>
                            <div class="emotion-value" id="neutral">0%</div>
                            <div class="correlation-indicator" id="neutralCorr">HR: --</div>
                        </div>
                    </div>
                </div>

                <!-- Biometric Data -->
                <div style="margin-bottom: var(--lg);">
                    <h3 style="margin-bottom: var(--md); color: var(--secondary);">💓 Biometric Monitoring</h3>
                    
                    <div class="biometric-display">
                        <span class="biometric-label">Heart Rate</span>
                        <span class="biometric-value" id="heartRate">72 BPM</span>
                    </div>
                    
                    <div class="biometric-display">
                        <span class="biometric-label">HRV</span>
                        <span class="biometric-value" id="hrv">45 ms</span>
                    </div>
                    
                    <div class="biometric-display">
                        <span class="biometric-label">Stress Level</span>
                        <span class="biometric-value" id="stressLevel">25%</span>
                    </div>
                    
                    <div class="biometric-display">
                        <span class="biometric-label">Respiratory Rate</span>
                        <span class="biometric-value" id="respRate">16 /min</span>
                    </div>
                    
                    <div class="biometric-display">
                        <span class="biometric-label">Voice Stress</span>
                        <span class="biometric-value" id="voiceStress">Low</span>
                    </div>
                </div>

                <!-- Correlation Matrix -->
                <div style="margin-bottom: var(--lg);">
                    <h3 style="margin-bottom: var(--md); color: var(--secondary);">🔗 Emotion-Biometric Correlation Matrix</h3>
                    
                    <div class="correlation-matrix" id="correlationMatrix">
                        <div class="correlation-cell">
                            <div class="correlation-value" id="hrEmotionCorr">0.87</div>
                            <div class="correlation-label">HR ↔ Emotion</div>
                        </div>
                        <div class="correlation-cell">
                            <div class="correlation-value" id="hrvEmotionCorr">0.73</div>
                            <div class="correlation-label">HRV ↔ Emotion</div>
                        </div>
                        <div class="correlation-cell">
                            <div class="correlation-value" id="stressEmotionCorr">0.91</div>
                            <div class="correlation-label">Stress ↔ Emotion</div>
                        </div>
                        <div class="correlation-cell">
                            <div class="correlation-value" id="voiceEmotionCorr">0.68</div>
                            <div class="correlation-label">Voice ↔ Emotion</div>
                        </div>
                        <div class="correlation-cell">
                            <div class="correlation-value" id="overallFusion">0.84</div>
                            <div class="correlation-label">Overall Fusion</div>
                        </div>
                        <div class="correlation-cell">
                            <div class="correlation-value" id="confidence">94%</div>
                            <div class="correlation-label">AI Confidence</div>
                        </div>
                    </div>
                </div>

                <!-- Sensor Integration -->
                <div class="grid-2" style="margin-bottom: var(--lg);">
                    <div style="background: var(--surface); border-radius: var(--border-radius); padding: var(--lg);">
                        <h3 style="margin-bottom: var(--md); color: var(--secondary);">📷 Facial Emotion Capture</h3>
                        
                        <div class="video-container">
                            <video id="facialVideo" autoplay muted playsinline class="hidden"></video>
                            <canvas id="facialCanvas" class="canvas-overlay hidden"></canvas>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: var(--md);">
                            <button class="btn emotion" onclick="startFacialEmotion()">Start Facial Analysis</button>
                            <button class="btn" onclick="stopFacialEmotion()">Stop</button>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="facialProgress" style="width: 0%"></div>
                        </div>
                    </div>

                    <div style="background: var(--surface); border-radius: var(--border-radius); padding: var(--lg);">
                        <h3 style="margin-bottom: var(--md); color: var(--secondary);">🎤 Voice Emotion Analysis</h3>
                        
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 3rem;">🎤</div>
                            <div id="voiceStatus">Voice analysis ready</div>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: var(--md);">
                            <button class="btn emotion" onclick="startVoiceEmotion()">Start Voice Analysis</button>
                            <button class="btn" onclick="stopVoiceEmotion()">Stop</button>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="voiceProgress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Fusion Controls -->
                <div style="text-align: center; margin-bottom: var(--lg);">
                    <h3 style="margin-bottom: var(--md); color: var(--secondary);">⚙️ Fusion Controls</h3>
                    
                    <div style="display: flex; gap: var(--sm); flex-wrap: wrap; justify-content: center;">
                        <button class="btn fusion" onclick="initializeFusion()">Initialize Fusion Engine</button>
                        <button class="btn fusion" onclick="calibrateSensors()">Calibrate Sensors</button>
                        <button class="btn fusion" onclick="startRealTimeFusion()">Start Real-time Fusion</button>
                        <button class="btn neural" onclick="exportFusionData()">Export Data</button>
                    </div>
                </div>

                <!-- Activity Log -->
                <div>
                    <h3 style="margin-bottom: var(--md); color: var(--secondary);">📋 Fusion Activity Log</h3>
                    <div class="log-container" id="activityLog">
                        <div class="log-entry info">System ready for emotional fusion analysis...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Health Section -->
        <div class="section health" id="health">
            <!-- Sub Navigation -->
            <div class="sub-nav">
                <div class="sub-nav-item active" onclick="switchHealthTab('overview', event)">Overview</div>
                <div class="sub-nav-item" onclick="switchHealthTab('biometrics', event)">Biometrics</div>
                <div class="sub-nav-item" onclick="switchHealthTab('sensors', event)">Phone Sensors</div>
                <div class="sub-nav-item" onclick="switchHealthTab('sleep', event)">Sleep</div>
                <div class="sub-nav-item" onclick="switchHealthTab('nutrition', event)">Nutrition</div>
                <div class="sub-nav-item" onclick="switchHealthTab('fitness', event)">Fitness</div>
            </div>

            <!-- Health Overview -->
            <div class="health-tab active" id="healthOverview">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>💗</span>
                            <span>Health Overview</span>
                        </div>
                        <div class="card-action">Details</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="progress-ring">
                                <svg><circle class="bg" cx="40" cy="40" r="36"></circle><circle class="progress" cx="40" cy="40" r="36" style="stroke-dashoffset: 50;"></circle></svg>
                                <div class="progress-text">89%</div>
                            </div>
                            <div class="stat-label" style="margin-top: var(--sm);">Sleep Quality</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">92%</div>
                            <div class="stat-label">Health Score</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">15%</div>
                            <div class="stat-label">Stress Level</div>
                        </div>
                    </div>

                    <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: var(--border-radius); padding: var(--md);">
                        <div style="font-weight: 700; margin-bottom: var(--sm); color: var(--success);">🍎 AI Nutrition Insight</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Your energy spikes 47 min after protein-rich meals. Optimize timing for peak performance.</div>
                    </div>

                    <div class="feature-grid" style="margin-top: var(--lg);">
                        <div class="feature-card" onclick="switchSection('emotionalFusion')">
                            <div class="feature-icon">🧠💓</div>
                            <div class="feature-title">Emotional Fusion</div>
                            <div class="feature-desc">Biometric-emotion analysis</div>
                        </div>
                        <div class="feature-card" onclick="startBiometricMonitoring()">
                            <div class="feature-icon">🧘</div>
                            <div class="feature-title">Stress Analysis</div>
                            <div class="feature-desc">Emotional-biometric fusion</div>
                        </div>
                        <div class="feature-card" onclick="uploadHealthPhoto()">
                            <div class="feature-icon">🥗</div>
                            <div class="feature-title">Nutrition Log</div>
                            <div class="feature-desc">Photo analysis ready</div>
                        </div>
                        <div class="feature-card" onclick="optimizeWorkout()">
                            <div class="feature-icon">💪</div>
                            <div class="feature-title">Workout Plan</div>
                            <div class="feature-desc">AI personalized</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Real-Time Biometrics Tab -->
            <div class="health-tab" id="healthBiometrics">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>📱💭</span>
                            <span>Real-Time Biometric-Emotional Fusion</span>
                        </div>
                        <div class="card-action" onclick="startBiometricMonitoring()">Start</div>
                    </div>
                    
                    <div style="text-align: center; padding: var(--lg); background: var(--surface); border-radius: var(--border-radius); margin-bottom: var(--lg);">
                        <div style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--sm); color: var(--success);" id="currentEmotionalState">Balanced State</div>
                        <div style="font-size: 1rem; color: var(--text-muted);" id="emotionalConfidence">85% Confidence</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: var(--sm);" id="emotionalRecommendations">Continue current activities • Monitor patterns</div>
                    </div>
                    
                    <div class="biometric-grid">
                        <div class="biometric-card heart">
                            <div style="font-size: 1.5rem; margin-bottom: var(--sm);">❤️</div>
                            <div class="biometric-value" id="heartRateDisplay">72 BPM</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Heart Rate</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 2px;" id="heartRateEmotion">Normal Range</div>
                        </div>
                        
                        <div class="biometric-card oxygen">
                            <div style="font-size: 1.5rem; margin-bottom: var(--sm);">🫁</div>
                            <div class="biometric-value" id="bloodOxygenDisplay">98%</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Blood O₂</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 2px;" id="oxygenEmotion">Excellent</div>
                        </div>
                        
                        <div class="biometric-card stress">
                            <div style="font-size: 1.5rem; margin-bottom: var(--sm);">🧘</div>
                            <div class="biometric-value" id="stressDisplay">15%</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Stress Level</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 2px;" id="stressEmotion">Well Managed</div>
                        </div>
                        
                        <div class="biometric-card hrv">
                            <div style="font-size: 1.5rem; margin-bottom: var(--sm);">📊</div>
                            <div class="biometric-value" id="hrvDisplay">42ms</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">HRV</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 2px;" id="hrvEmotion">Good Recovery</div>
                        </div>
                    </div>

                    <!-- Advanced Biometric Data -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--sm); margin: var(--md) 0;">
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--sm); text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Breathing Rate</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: var(--info);" id="breathingRateDisplay">16/min</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--sm); text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Facial Tension</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: var(--success);" id="facialTensionDisplay">12%</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--sm); text-align: center;">
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Skin Conductance</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: var(--warning);" id="skinConductanceDisplay">0.8μS</div>
                        </div>
                    </div>

                    <!-- Real-Time Correlations -->
                    <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); margin: var(--md) 0;">
                        <div style="font-size: 0.85rem; font-weight: 600; margin-bottom: var(--sm); color: var(--secondary);">🧠💓 Real-Time Emotional-Biometric Correlations</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sm);">
                            <div style="font-size: 0.75rem;">
                                <span style="color: var(--text-muted);">Stress-HR Correlation:</span>
                                <span style="color: var(--warning); font-weight: 600;" id="stressHRCorrelation">0.73</span>
                            </div>
                            <div style="font-size: 0.75rem;">
                                <span style="color: var(--text-muted);">Focus Coherence:</span>
                                <span style="color: var(--success); font-weight: 600;" id="focusCoherence">0.84</span>
                            </div>
                            <div style="font-size: 0.75rem;">
                                <span style="color: var(--text-muted);">Anxiety-Breathing:</span>
                                <span style="color: var(--info); font-weight: 600;" id="anxietyBreathingCorrelation">0.68</span>
                            </div>
                            <div style="font-size: 0.75rem;">
                                <span style="color: var(--text-muted);">Emotional Arousal:</span>
                                <span style="color: var(--primary); font-weight: 600;" id="emotionalArousal">0.45</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phone Sensors Tab -->
            <div class="health-tab" id="healthSensors">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>📱</span>
                            <span>Phone Sensors Analysis</span>
                        </div>
                        <div class="card-action" onclick="openSensorsOverlay()">Open Manager</div>
                    </div>

                    <div style="text-align: center; padding: var(--lg); background: var(--surface); border-radius: var(--border-radius); margin-bottom: var(--lg);">
                        <div style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--sm); color: var(--primary);">Phone Sensors Intelligence</div>
                        <div style="font-size: 1rem; color: var(--text-muted);">Environmental Context & Motion Analysis</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">3</div>
                            <div class="stat-label">Active Sensors</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">1.2</div>
                            <div class="stat-label">Motion (m/s²)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">450</div>
                            <div class="stat-label">Light (lux)</div>
                        </div>
                    </div>

                    <div class="feature-grid" style="margin-top: var(--lg);">
                        <div class="feature-card" onclick="toggleAccelerometer()">
                            <div class="feature-icon">📱</div>
                            <div class="feature-title">Accelerometer</div>
                            <div class="feature-desc">Motion detection</div>
                        </div>
                        <div class="feature-card" onclick="toggleLightSensor()">
                            <div class="feature-icon">💡</div>
                            <div class="feature-title">Light Sensor</div>
                            <div class="feature-desc">Environment analysis</div>
                        </div>
                        <div class="feature-card" onclick="toggleAudioAnalysis()">
                            <div class="feature-icon">🎤</div>
                            <div class="feature-title">Audio Analysis</div>
                            <div class="feature-desc">Sound environment</div>
                        </div>
                        <div class="feature-card" onclick="openSensorsOverlay()">
                            <div class="feature-icon">⚙️</div>
                            <div class="feature-title">Full Manager</div>
                            <div class="feature-desc">Complete interface</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sleep Tab -->
            <div class="health-tab" id="healthSleep">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>😴</span>
                            <span>Sleep Optimization</span>
                        </div>
                        <div class="card-action">Analyze</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">89%</div>
                            <div class="stat-label">Sleep Quality</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">7h 23m</div>
                            <div class="stat-label">Duration</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">76%</div>
                            <div class="stat-label">Recovery Score</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Nutrition Tab -->
            <div class="health-tab" id="healthNutrition">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🥗</span>
                            <span>Nutrition Intelligence</span>
                        </div>
                        <div class="card-action" onclick="uploadHealthPhoto()">Log Meal</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">84%</div>
                            <div class="stat-label">Nutrition Score</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">12</div>
                            <div class="stat-label">Meals Logged</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">47min</div>
                            <div class="stat-label">Energy Boost</div>
                        </div>
                    </div>

                    <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: var(--border-radius); padding: var(--md);">
                        <div style="font-weight: 700; margin-bottom: var(--sm); color: var(--success);">🍎 AI Nutrition Insight</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Your energy spikes 47 min after protein-rich meals. Optimize timing for peak performance.</div>
                    </div>
                </div>
            </div>

            <!-- Fitness Tab -->
            <div class="health-tab" id="healthFitness">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>💪</span>
                            <span>Fitness & Activity</span>
                        </div>
                        <div class="card-action">Workout</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">91%</div>
                            <div class="stat-label">Fitness Level</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">12</div>
                            <div class="stat-label">Day Streak</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">1.5x</div>
                            <div class="stat-label">Energy Bonus</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Section -->
        <div class="section performance" id="performance">
            <!-- Sub Navigation -->
            <div class="sub-nav">
                <div class="sub-nav-item active" onclick="switchPerformanceTab('productivity', event)">Productivity</div>
                <div class="sub-nav-item" onclick="switchPerformanceTab('energy', event)">Energy</div>
                <div class="sub-nav-item" onclick="switchPerformanceTab('goals', event)">Goals</div>
                <div class="sub-nav-item" onclick="switchPerformanceTab('strategy', event)">Strategy</div>
            </div>

            <!-- Productivity Tab -->
            <div class="performance-tab active" id="performanceProductivity">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>⚡</span>
                            <span>Productivity & Energy</span>
                        </div>
                        <div class="card-action" onclick="optimizeProductivity()">Optimize</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">82%</div>
                            <div class="stat-label">Energy Level</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">3.2h</div>
                            <div class="stat-label">Deep Work</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">88%</div>
                            <div class="stat-label">Efficiency</div>
                        </div>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card" onclick="startFocusSession()">
                            <div class="feature-icon">🎯</div>
                            <div class="feature-title">Focus Session</div>
                            <div class="feature-desc">Start deep work</div>
                        </div>
                        <div class="feature-card" onclick="analyzeScreenTime()">
                            <div class="feature-icon">📱</div>
                            <div class="feature-title">Screen Intelligence</div>
                            <div class="feature-desc">68% productive time</div>
                        </div>
                        <div class="feature-card" onclick="energyOptimization()">
                            <div class="feature-icon">⚡</div>
                            <div class="feature-title">Energy Plan</div>
                            <div class="feature-desc">Optimize allocation</div>
                        </div>
                        <div class="feature-card" onclick="obstacleAnticipation()">
                            <div class="feature-icon">🛡️</div>
                            <div class="feature-title">Obstacle Prep</div>
                            <div class="feature-desc">91% accuracy</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Energy Tab -->
            <div class="performance-tab" id="performanceEnergy">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>⚡</span>
                            <span>Energy Investment Planning</span>
                        </div>
                        <div class="card-action">Optimize</div>
                    </div>

                    <!-- Energy Allocation -->
                    <div style="margin-bottom: var(--lg);">
                        <div style="font-weight: 600; margin-bottom: var(--md); color: var(--secondary);">100 Energy Points Available</div>
                        
                        <div style="display: flex; flex-direction: column; gap: var(--md);">
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--sm); font-size: 0.85rem;">
                                    <span style="font-weight: 600;">🎯 Deep Work</span>
                                    <span style="color: var(--warning); font-weight: 600;">45 points</span>
                                </div>
                                <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                    <div style="height: 100%; background: var(--ai-productivity); border-radius: 4px; width: 45%; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                            
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--sm); font-size: 0.85rem;">
                                    <span style="font-weight: 600;">🤝 Social/Meetings</span>
                                    <span style="color: var(--warning); font-weight: 600;">25 points</span>
                                </div>
                                <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                    <div style="height: 100%; background: var(--ai-social); border-radius: 4px; width: 25%; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                            
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--sm); font-size: 0.85rem;">
                                    <span style="font-weight: 600;">📚 Learning</span>
                                    <span style="color: var(--warning); font-weight: 600;">20 points</span>
                                </div>
                                <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                                    <div style="height: 100%; background: var(--ai-learning); border-radius: 4px; width: 20%; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Goals Tab -->
            <div class="performance-tab" id="performanceGoals">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🏆</span>
                            <span>Goals & Achievement</span>
                        </div>
                        <div class="card-action">Update</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">76%</div>
                            <div class="stat-label">Goal Progress</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">94%</div>
                            <div class="stat-label">Achievement Rate</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">82%</div>
                            <div class="stat-label">Milestones</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Strategy Tab -->
            <div class="performance-tab" id="performanceStrategy">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🎯</span>
                            <span>Strategy & Decision Making</span>
                        </div>
                        <div class="card-action">Analyze</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">89%</div>
                            <div class="stat-label">Decision Quality</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">91%</div>
                            <div class="stat-label">Strategic Thinking</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">78%</div>
                            <div class="stat-label">Execution Rate</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Growth Section -->
        <div class="section growth" id="growth">
            <!-- Sub Navigation -->
            <div class="sub-nav">
                <div class="sub-nav-item active" onclick="switchGrowthTab('learning', event)">Learning</div>
                <div class="sub-nav-item" onclick="switchGrowthTab('habits', event)">Habits</div>
                <div class="sub-nav-item" onclick="switchGrowthTab('social', event)">Social</div>
                <div class="sub-nav-item" onclick="switchGrowthTab('emotional', event)">Emotional</div>
                <div class="sub-nav-item" onclick="switchGrowthTab('labs', event)">AI Labs</div>
            </div>

            <!-- Learning Tab -->
            <div class="growth-tab active" id="growthLearning">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>📚</span>
                            <span>Learning & Growth</span>
                        </div>
                        <div class="card-action">Plan</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">94%</div>
                            <div class="stat-label">Learning Rate</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">88%</div>
                            <div class="stat-label">Retention</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">92%</div>
                            <div class="stat-label">Growth Mindset</div>
                        </div>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-icon">🎥</div>
                            <div class="feature-title">Video Learning</div>
                            <div class="feature-desc">97% match rate</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">📖</div>
                            <div class="feature-title">Reading Plan</div>
                            <div class="feature-desc">Personalized content</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎧</div>
                            <div class="feature-title">Podcast Queue</div>
                            <div class="feature-desc">23 min optimal</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎯</div>
                            <div class="feature-title">Skill Tracker</div>
                            <div class="feature-desc">76% development</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Habits Tab -->
            <div class="growth-tab" id="growthHabits">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🔄</span>
                            <span>Habits & Behavior</span>
                        </div>
                        <div class="card-action">Track</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">87%</div>
                            <div class="stat-label">Consistency</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">7</div>
                            <div class="stat-label">Active Streaks</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">92%</div>
                            <div class="stat-label">Routine Quality</div>
                        </div>
                    </div>

                    <!-- Active Streaks -->
                    <div style="margin-top: var(--lg);">
                        <div style="font-weight: 600; margin-bottom: var(--md); color: var(--secondary);">🔥 Active Streaks & Multipliers</div>
                        
                        <div style="display: flex; flex-direction: column; gap: var(--md);">
                            <div class="streak-card active-streak">
                                <div style="font-size: 1.5rem;">🧘</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: var(--text-primary);">Meditation</div>
                                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--success);">7 days</div>
                                    <div style="font-size: 0.8rem; color: var(--warning); font-weight: 600; background: rgba(245, 158, 11, 0.2); padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 2px;">2x Focus Bonus Active!</div>
                                </div>
                            </div>
                            
                            <div class="streak-card active-streak">
                                <div style="font-size: 1.5rem;">🏃</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: var(--text-primary);">Exercise</div>
                                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--success);">12 days</div>
                                    <div style="font-size: 0.8rem; color: var(--warning); font-weight: 600; background: rgba(245, 158, 11, 0.2); padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 2px;">1.5x Energy Boost!</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social Tab -->
            <div class="growth-tab" id="growthSocial">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🤝</span>
                            <span>Social & Relationships</span>
                        </div>
                        <div class="card-action">Analyze</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">91%</div>
                            <div class="stat-label">Relationship Quality</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">84%</div>
                            <div class="stat-label">Social Energy</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">88%</div>
                            <div class="stat-label">Communication</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Emotional Tab -->
            <div class="growth-tab" id="growthEmotional">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>😊</span>
                            <span>Emotional Intelligence</span>
                        </div>
                        <div class="card-action">Scan</div>
                    </div>

                    <div style="text-align: center; padding: var(--xl) var(--lg); background: var(--surface); border-radius: var(--border-radius); margin: var(--lg) 0;">
                        <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: var(--sm); background: var(--ai-emotion); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                            Transcendent Joy
                        </div>
                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--success);">97.8% Confidence</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">94%</div>
                            <div class="stat-label">Emotional Balance</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">87%</div>
                            <div class="stat-label">Social Intelligence</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">92%</div>
                            <div class="stat-label">Self-Awareness</div>
                        </div>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card" onclick="startCameraMood()">
                            <div class="feature-icon">📷</div>
                            <div class="feature-title">Mood Scanner</div>
                            <div class="feature-desc">Real-time analysis</div>
                        </div>
                        <div class="feature-card" onclick="startVoiceJournal()">
                            <div class="feature-icon">🎙️</div>
                            <div class="feature-title">Voice Journal</div>
                            <div class="feature-desc">Emotion tracking</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Labs Tab -->
            <div class="growth-tab" id="growthLabs">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🔬</span>
                            <span>AI Analysis Laboratories</span>
                        </div>
                        <div class="card-action" onclick="openLabs()">Open Full Interface</div>
                    </div>

                    <!-- Lab Overview -->
                    <div style="text-align: center; margin-bottom: var(--xl);">
                        <div style="font-size: 1.3rem; font-weight: 800; margin-bottom: var(--sm); background: var(--ai-learning); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Advanced AI Research</div>
                        <div style="color: var(--text-muted); font-size: 0.9rem;">Specialized Deep Analysis Tools</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">6</div>
                            <div class="stat-label">Available Labs</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">4</div>
                            <div class="stat-label">Active Labs</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">1,247</div>
                            <div class="stat-label">Analysis Points</div>
                        </div>
                    </div>

                    <!-- Quick Lab Access -->
                    <div style="margin-bottom: var(--lg);">
                        <div style="font-weight: 600; margin-bottom: var(--md); color: var(--secondary);">🔬 Quick Lab Access</div>
                        
                        <div class="grid-2" style="gap: var(--md);">
                            <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); cursor: pointer;" onclick="openLab('emotional-fusion')">
                                <div style="display: flex; align-items: center; gap: var(--sm); margin-bottom: var(--sm);">
                                    <span style="font-size: 1.2rem;">🧠💓</span>
                                    <span style="font-weight: 600; color: var(--text-primary);">Emotional Fusion</span>
                                    <span style="background: var(--success); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem;">Active</span>
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">Biometric-emotion correlation</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); cursor: pointer;" onclick="openLab('quantum')">
                                <div style="display: flex; align-items: center; gap: var(--sm); margin-bottom: var(--sm);">
                                    <span style="font-size: 1.2rem;">⚛️</span>
                                    <span style="font-weight: 600; color: var(--text-primary);">Quantum Analysis</span>
                                    <span style="background: var(--accent); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem;">Active</span>
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">Quantum computing simulation</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); cursor: pointer;" onclick="openLab('personality')">
                                <div style="display: flex; align-items: center; gap: var(--sm); margin-bottom: var(--sm);">
                                    <span style="font-size: 1.2rem;">📊</span>
                                    <span style="font-weight: 600; color: var(--text-primary);">Personality Testing</span>
                                    <span style="background: var(--info); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem;">Ready</span>
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">Big Five + AI assessment</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); cursor: pointer;" onclick="openLab('predictive')">
                                <div style="display: flex; align-items: center; gap: var(--sm); margin-bottom: var(--sm);">
                                    <span style="font-size: 1.2rem;">🔮</span>
                                    <span style="font-weight: 600; color: var(--text-primary);">Predictive Intelligence</span>
                                    <span style="background: var(--warning); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem;">Beta</span>
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">AI-powered forecasting</div>
                            </div>
                        </div>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card" onclick="openLabs()">
                            <div class="feature-icon">🔬</div>
                            <div class="feature-title">Full Laboratory</div>
                            <div class="feature-desc">Complete interface</div>
                        </div>
                        <div class="feature-card" onclick="switchSection('emotionalFusion')">
                            <div class="feature-icon">🧠💓</div>
                            <div class="feature-title">Fusion Engine</div>
                            <div class="feature-desc">Direct access</div>
                        </div>
                        <div class="feature-card" onclick="switchSection('health'); switchHealthTab('sensors', event);">
                            <div class="feature-icon">📱</div>
                            <div class="feature-title">Phone Sensors</div>
                            <div class="feature-desc">Sensor manager</div>
                        </div>
                        <div class="feature-card" onclick="runAdvancedAnalysis()">
                            <div class="feature-icon">🎯</div>
                            <div class="feature-title">Run Analysis</div>
                            <div class="feature-desc">Start all labs</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Section -->
        <div class="section" id="profile">
            <!-- Profile Overview -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span>👤</span>
                        <span>Your Profile</span>
                    </div>
                    <div class="card-action" onclick="openSettings()">Settings</div>
                </div>

                <!-- Character Classes Preview -->
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-value">Lvl 15</div>
                        <div class="stat-label">Productivity Warrior</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">Lvl 12</div>
                        <div class="stat-label">Health Mage</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">8,534</div>
                        <div class="stat-label">Total XP</div>
                    </div>
                </div>

                <div class="feature-grid">
                    <div class="feature-card" onclick="switchProfileTab('achievements')">
                        <div class="feature-icon">🎮</div>
                        <div class="feature-title">Achievements</div>
                        <div class="feature-desc">View all badges</div>
                    </div>
                    <div class="feature-card" onclick="switchProfileTab('integrations')">
                        <div class="feature-icon">🔗</div>
                        <div class="feature-title">Integrations</div>
                        <div class="feature-desc">3/6 connected</div>
                    </div>
                    <div class="feature-card" onclick="toggleLabs()">
                        <div class="feature-icon">🔬</div>
                        <div class="feature-title">AI Labs</div>
                        <div class="feature-desc">Advanced features</div>
                    </div>
                    <div class="feature-card" onclick="switchProfileTab('analytics')">
                        <div class="feature-icon">📊</div>
                        <div class="feature-title">Analytics</div>
                        <div class="feature-desc">Deep insights</div>
                    </div>
                </div>
            </div>

            <!-- Achievements Tab -->
            <div class="profile-tab" id="profileAchievements">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🎮</span>
                            <span>Achievements & Gamification</span>
                        </div>
                        <div class="card-action">Check Progress</div>
                    </div>

                    <!-- Character Classes -->
                    <div style="margin-bottom: var(--xl);">
                        <div class="class-card productivity-warrior">
                            <div class="class-header">
                                <div class="class-icon">⚔️</div>
                                <div class="class-info">
                                    <div class="class-name">Productivity Warrior</div>
                                    <div class="class-level">Level 15</div>
                                </div>
                                <div style="text-align: right; min-width: 120px;">
                                    <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 4px;">2847/3200 XP</div>
                                    <div class="xp-bar">
                                        <div class="xp-progress" style="width: 89%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary); font-style: italic;">Master of focus, efficiency, and strategic execution</div>
                        </div>
                        
                        <div class="class-card health-mage">
                            <div class="class-header">
                                <div class="class-icon">🔮</div>
                                <div class="class-info">
                                    <div class="class-name">Health Mage</div>
                                    <div class="class-level">Level 12</div>
                                </div>
                                <div style="text-align: right; min-width: 120px;">
                                    <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 4px;">1856/2400 XP</div>
                                    <div class="xp-bar">
                                        <div class="xp-progress" style="width: 77%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary); font-style: italic;">Master of wellness, recovery, and vitality</div>
                        </div>
                        
                        <div class="class-card social-diplomat">
                            <div class="class-header">
                                <div class="class-icon">🤝</div>
                                <div class="class-info">
                                    <div class="class-name">Social Diplomat</div>
                                    <div class="class-level">Level 8</div>
                                </div>
                                <div style="text-align: right; min-width: 120px;">
                                    <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 4px;">1456/1800 XP</div>
                                    <div class="xp-bar">
                                        <div class="xp-progress" style="width: 81%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary); font-style: italic;">Expert of relationships and communication</div>
                        </div>
                    </div>

                    <!-- Achievement Badges -->
                    <div style="margin-top: var(--xl);">
                        <div style="font-weight: 600; margin-bottom: var(--md); color: var(--secondary);">🏅 Achievement Gallery</div>
                        
                        <div class="achievement-badge unlocked">
                            <div class="badge-icon">🛡️</div>
                            <div class="badge-info">
                                <div class="badge-name">Health Guardian</div>
                                <div class="badge-desc">7 days perfect health metrics</div>
                            </div>
                        </div>
                        
                        <div class="achievement-badge unlocked">
                            <div class="badge-icon">🎯</div>
                            <div class="badge-info">
                                <div class="badge-name">Focus Master</div>
                                <div class="badge-desc">3+ hours deep work daily</div>
                            </div>
                        </div>
                        
                        <div class="achievement-badge unlocked">
                            <div class="badge-icon">🦋</div>
                            <div class="badge-info">
                                <div class="badge-name">Social Butterfly</div>
                                <div class="badge-desc">Excellent social connections</div>
                            </div>
                        </div>
                        
                        <div class="achievement-badge unlocked">
                            <div class="badge-icon">📱</div>
                            <div class="badge-info">
                                <div class="badge-name">Biometric Master</div>
                                <div class="badge-desc">1000+ biometric data points</div>
                            </div>
                        </div>
                        
                        <div class="achievement-badge unlocked">
                            <div class="badge-icon">⚛️</div>
                            <div class="badge-info">
                                <div class="badge-name">Quantum Pioneer</div>
                                <div class="badge-desc">First to use quantum optimization</div>
                            </div>
                        </div>
                        
                        <div class="achievement-badge locked">
                            <div class="badge-icon">⌚</div>
                            <div class="badge-info">
                                <div class="badge-name">Vital Signs Guru</div>
                                <div class="badge-desc">Perfect week of health metrics</div>
                            </div>
                        </div>
                        
                        <div class="achievement-badge locked">
                            <div class="badge-icon">👑</div>
                            <div class="badge-info">
                                <div class="badge-name">Life Optimizer</div>
                                <div class="badge-desc">Level 20 in all classes</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Integrations Tab -->
            <div class="profile-tab" id="profileIntegrations">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🔗</span>
                            <span>Integration Ecosystem</span>
                        </div>
                        <div class="card-action">Analyze</div>
                    </div>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius); padding: var(--md); margin-bottom: var(--lg);">
                        <div style="font-size: 0.85rem; font-weight: 600; margin-bottom: var(--sm); color: var(--secondary);">🔗 Integration Status</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Calendar optimization • Email sentiment tracking • Smart environment ready</div>
                    </div>
                    
                    <div class="integration-grid">
                        <div class="integration-item active">
                            <div style="font-size: 1.2rem;">📅</div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.8rem; color: var(--text-primary); margin-bottom: 2px;">Calendar Intelligence</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Energy-based scheduling</div>
                            </div>
                            <div class="integration-badge connected">●</div>
                        </div>
                        
                        <div class="integration-item active">
                            <div style="font-size: 1.2rem;">📧</div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.8rem; color: var(--text-primary); margin-bottom: 2px;">Email Sentiment</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Communication analysis</div>
                            </div>
                            <div class="integration-badge connected">●</div>
                        </div>
                        
                        <div class="integration-item active">
                            <div style="font-size: 1.2rem;">📱</div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.8rem; color: var(--text-primary); margin-bottom: 2px;">Biometric Monitoring</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Real-time health tracking</div>
                            </div>
                            <div class="integration-badge connected">●</div>
                        </div>
                        
                        <div class="integration-item">
                            <div style="font-size: 1.2rem;">🏠</div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.8rem; color: var(--text-primary); margin-bottom: 2px;">Smart Home</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Environment optimization</div>
                            </div>
                            <div class="integration-badge">●</div>
                        </div>
                        
                        <div class="integration-item">
                            <div style="font-size: 1.2rem;">💰</div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.8rem; color: var(--text-primary); margin-bottom: 2px;">Financial Wellness</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Spending & mood correlation</div>
                            </div>
                            <div class="integration-badge">●</div>
                        </div>
                        
                        <div class="integration-item">
                            <div style="font-size: 1.2rem;">⌚</div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.8rem; color: var(--text-primary); margin-bottom: 2px;">Wearable Devices</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Watch & fitness tracker sync</div>
                            </div>
                            <div class="integration-badge">●</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--sm); margin: var(--md) 0; font-size: 0.75rem;">
                        <div style="text-align: center; padding: var(--sm); background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius);">
                            <div style="color: var(--text-muted); margin-bottom: 2px;">Connected Platforms</div>
                            <div style="font-weight: 600; color: var(--text-primary);">3/6</div>
                        </div>
                        <div style="text-align: center; padding: var(--sm); background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius);">
                            <div style="color: var(--text-muted); margin-bottom: 2px;">Time Saved This Week</div>
                            <div style="font-weight: 600; color: var(--text-primary);">127 min</div>
                        </div>
                        <div style="text-align: center; padding: var(--sm); background: rgba(255, 255, 255, 0.05); border-radius: var(--border-radius);">
                            <div style="color: var(--text-muted); margin-bottom: 2px;">Cross-Platform Insights</div>
                            <div style="font-weight: 600; color: var(--text-primary);">4</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Labs Tab -->
            <div class="profile-tab" id="profileLabs">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>🔬</span>
                            <span>AI Analysis Laboratories</span>
                        </div>
                        <div class="card-action">Research</div>
                    </div>
                    
                    <div style="text-align: center; margin-bottom: var(--xl);">
                        <div style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--sm); background: var(--ai-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Advanced AI Research</div>
                        <div style="color: var(--text-muted); font-size: 0.9rem;">Specialized Deep Analysis Tools</div>
                        <button class="btn quantum" onclick="toggleLabs()" style="margin-top: var(--md);">
                            <span>⚛️</span><span>Open Quantum Labs</span>
                        </button>
                    </div>
                    
                    <div class="labs-grid">
                        <div class="lab-card" onclick="openLab('deep-emotion')">
                            <div class="lab-icon">🔬</div>
                            <div class="lab-title">Deep Emotion Analysis</div>
                            <div class="lab-desc">Multimodal emotion fusion</div>
                        </div>
                        
                        <div class="lab-card" onclick="openLab('personality')">
                            <div class="lab-icon">📊</div>
                            <div class="lab-title">Personality Testing</div>
                            <div class="lab-desc">Big Five + AI assessment</div>
                        </div>
                        
                        <div class="lab-card" onclick="openLab('predictive')">
                            <div class="lab-icon">🔮</div>
                            <div class="lab-title">Predictive Intelligence</div>
                            <div class="lab-desc">AI-powered forecasting</div>
                        </div>
                        
                        <div class="lab-card" onclick="openLab('multimodal')">
                            <div class="lab-icon">🎯</div>
                            <div class="lab-title">Multimodal Fusion</div>
                            <div class="lab-desc">Cross-sensory analysis</div>
                        </div>
                        
                        <div class="lab-card" onclick="openLab('quantum')">
                            <div class="lab-icon">⚛️</div>
                            <div class="lab-title">Quantum Analysis</div>
                            <div class="lab-desc">Quantum computing simulation</div>
                        </div>
                        
                        <div class="lab-card" onclick="openLab('biometric')">
                            <div class="lab-icon">💓</div>
                            <div class="lab-title">Biometric Integration</div>
                            <div class="lab-desc">Real-time biometric fusion</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div class="profile-tab" id="profileAnalytics">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>📊</span>
                            <span>Analytics & Insights</span>
                        </div>
                        <div class="card-action">Export</div>
                    </div>

                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value">156</div>
                            <div class="stat-label">Optimizations</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">91%</div>
                            <div class="stat-label">AI Accuracy</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">1,247</div>
                            <div class="stat-label">Data Points</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-items">
            <div class="nav-item active" data-section="aiCoach" onclick="switchSection('aiCoach')">
                <div class="nav-icon">🤖</div>
                <div class="nav-label">AI Coach</div>
            </div>
            <div class="nav-item" data-section="emotionalFusion" onclick="switchSection('emotionalFusion')">
                <div class="nav-icon">🧠💓</div>
                <div class="nav-label">Fusion</div>
            </div>
            <div class="nav-item" data-section="health" onclick="switchSection('health')">
                <div class="nav-icon">💗</div>
                <div class="nav-label">Health</div>
            </div>
            <div class="nav-item" data-section="performance" onclick="switchSection('performance')">
                <div class="nav-icon">⚡</div>
                <div class="nav-label">Performance</div>
            </div>
            <div class="nav-item" data-section="growth" onclick="switchSection('growth')">
                <div class="nav-icon">📚</div>
                <div class="nav-label">Growth</div>
            </div>
            <div class="nav-item" data-section="profile" onclick="switchSection('profile')">
                <div class="nav-icon">👤</div>
                <div class="nav-label">Profile</div>
            </div>
        </div>
    </nav>

    <!-- Labs Overlay -->
    <div class="labs-overlay" id="labsOverlay">
        <div class="labs-content">
            <div class="labs-header">
                <div class="labs-title">⚛️ Quantum AI Analysis Laboratories</div>
                <div class="labs-subtitle">Specialized Deep Analysis Tools</div>
                <button class="labs-close" onclick="closeLabs()">×</button>
            </div>
            
            <div class="labs-grid">
                <div class="lab-card active" onclick="openLab('emotional-fusion')">
                    <div class="lab-icon">🧠💓</div>
                    <div class="lab-title">Emotional Fusion Engine</div>
                    <div class="lab-desc">Biometric-emotion correlation</div>
                    <div class="lab-status">Active</div>
                </div>
                
                <div class="lab-card" onclick="openLab('personality')">
                    <div class="lab-icon">📊</div>
                    <div class="lab-title">Personality Testing</div>
                    <div class="lab-desc">Big Five + AI assessment</div>
                    <div class="lab-status">Ready</div>
                </div>
                
                <div class="lab-card" onclick="openLab('predictive')">
                    <div class="lab-icon">🔮</div>
                    <div class="lab-title">Predictive Intelligence</div>
                    <div class="lab-desc">AI-powered forecasting</div>
                    <div class="lab-status">Beta</div>
                </div>
                
                <div class="lab-card" onclick="openLab('multimodal')">
                    <div class="lab-icon">🎯</div>
                    <div class="lab-title">Multimodal Fusion</div>
                    <div class="lab-desc">Cross-sensory analysis</div>
                    <div class="lab-status">Ready</div>
                </div>
                
                <div class="lab-card quantum" onclick="openLab('quantum')">
                    <div class="lab-icon">⚛️</div>
                    <div class="lab-title">Quantum Analysis</div>
                    <div class="lab-desc">Quantum computing simulation</div>
                    <div class="lab-status">Active</div>
                </div>
                
                <div class="lab-card active" onclick="openLab('biometric')">
                    <div class="lab-icon">💓</div>
                    <div class="lab-title">Biometric Integration</div>
                    <div class="lab-desc">Real-time biometric fusion</div>
                    <div class="lab-status">Active</div>
                </div>
            </div>
            
            <div class="labs-stats">
                <div class="lab-stat">
                    <div class="stat-value">4</div>
                    <div class="stat-label">Active Labs</div>
                </div>
                <div class="lab-stat">
                    <div class="stat-value">6</div>
                    <div class="stat-label">Total Labs</div>
                </div>
                <div class="lab-stat">
                    <div class="stat-value">1,247</div>
                    <div class="stat-label">Analysis Points</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Phone Sensors Overlay -->
    <div class="sensors-overlay" id="sensorsOverlay">
        <div class="sensors-content">
            <div class="sensors-header">
                <div class="sensors-title">📱 Phone Sensors Manager</div>
                <div class="sensors-subtitle">Accelerometer • Light Sensor • Audio Analysis</div>
                <button class="sensors-close" onclick="closeSensorsOverlay()">×</button>
            </div>

            <!-- Accelerometer Card -->
            <div class="sensor-card">
                <div class="sensor-header">
                    <div class="sensor-title">
                        <span>📱</span>
                        <span>Accelerometer</span>
                    </div>
                    <div class="status-indicator" id="accelStatus"></div>
                </div>

                <div class="sensor-data">
                    <div class="data-item">
                        <div class="data-value" id="accelX">0.0</div>
                        <div class="data-label">X-Axis</div>
                    </div>
                    <div class="data-item">
                        <div class="data-value" id="accelY">0.0</div>
                        <div class="data-label">Y-Axis</div>
                    </div>
                    <div class="data-item">
                        <div class="data-value" id="accelZ">0.0</div>
                        <div class="data-label">Z-Axis</div>
                    </div>
                    <div class="data-item">
                        <div class="data-value" id="accelMagnitude">0.0</div>
                        <div class="data-label">Magnitude</div>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="accelChart" class="chart-canvas"></canvas>
                </div>

                <div class="permission-notice" id="accelPermission" style="display: none;">
                    🔒 Motion sensors require permission on iOS 13+. Tap to request access.
                </div>

                <button class="btn" id="accelBtn" onclick="toggleAccelerometer()">
                    <span>🚀</span>
                    <span>Start Accelerometer</span>
                </button>

                <div class="data-stream" id="accelStream"></div>
            </div>

            <!-- Light Sensor Card -->
            <div class="sensor-card">
                <div class="sensor-header">
                    <div class="sensor-title">
                        <span>💡</span>
                        <span>Light Sensor</span>
                    </div>
                    <div class="status-indicator" id="lightStatus"></div>
                </div>

                <div class="sensor-data">
                    <div class="data-item">
                        <div class="data-value" id="lightLevel">---</div>
                        <div class="data-label">Lux Level</div>
                    </div>
                    <div class="data-item">
                        <div class="data-value" id="lightCondition">Unknown</div>
                        <div class="data-label">Condition</div>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="lightChart" class="chart-canvas"></canvas>
                </div>

                <div class="sensor-info">
                    💡 Light sensor data estimated from device brightness and ambient light API when available
                </div>

                <button class="btn" id="lightBtn" onclick="toggleLightSensor()">
                    <span>🌟</span>
                    <span>Start Light Monitoring</span>
                </button>

                <div class="data-stream" id="lightStream"></div>
            </div>

            <!-- Audio Analysis Card -->
            <div class="sensor-card">
                <div class="sensor-header">
                    <div class="sensor-title">
                        <span>🎤</span>
                        <span>Audio Analysis</span>
                    </div>
                    <div class="status-indicator" id="audioStatus"></div>
                </div>

                <div class="sensor-data">
                    <div class="data-item">
                        <div class="data-value" id="audioVolume">0</div>
                        <div class="data-label">Volume dB</div>
                    </div>
                    <div class="data-item">
                        <div class="data-value" id="audioFreq">---</div>
                        <div class="data-label">Peak Freq Hz</div>
                    </div>
                    <div class="data-item">
                        <div class="data-value" id="audioActivity">Quiet</div>
                        <div class="data-label">Activity</div>
                    </div>
                </div>

                <div class="audio-visualizer" id="audioVisualizer">
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                    <div class="audio-bar"></div>
                </div>

                <div class="permission-notice" id="audioPermission" style="display: none;">
                    🎤 Microphone access required for audio analysis
                </div>

                <button class="btn" id="audioBtn" onclick="toggleAudioAnalysis()">
                    <span>🎵</span>
                    <span>Start Audio Analysis</span>
                </button>

                <div class="data-stream" id="audioStream"></div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // ====================================
        // PHONE SENSORS MANAGER INTEGRATION
        // ====================================
        
        class PhoneSensorsManager {
            constructor() {
                this.sensors = {
                    accelerometer: {
                        active: false,
                        data: { x: 0, y: 0, z: 0, magnitude: 0 },
                        history: []
                    },
                    light: {
                        active: false,
                        data: { level: 0, condition: 'Unknown' },
                        history: []
                    },
                    audio: {
                        active: false,
                        data: { volume: 0, frequency: 0, activity: 'Quiet' },
                        stream: null,
                        context: null,
                        analyser: null
                    }
                };
                
                this.charts = {};
                this.init();
            }

            init() {
                this.setupCharts();
                this.checkPermissions();
                this.log('📱 Phone Sensors Manager initialized');
                this.showNotification('📱 Sensors ready for activation', 'success');
            }

            // Accelerometer Functions
            async startAccelerometer() {
                try {
                    // Check for iOS 13+ permission request
                    if (typeof DeviceMotionEvent !== 'undefined' && 
                        typeof DeviceMotionEvent.requestPermission === 'function') {
                        
                        document.getElementById('accelPermission').style.display = 'block';
                        const permission = await DeviceMotionEvent.requestPermission();
                        document.getElementById('accelPermission').style.display = 'none';
                        
                        if (permission !== 'granted') {
                            throw new Error('Motion permission denied');
                        }
                    }

                    window.addEventListener('devicemotion', this.handleDeviceMotion.bind(this));
                    this.sensors.accelerometer.active = true;
                    this.updateSensorStatus('accelStatus', 'connected');
                    this.updateButton('accelBtn', 'stop', '⏹️', 'Stop Accelerometer');
                    this.log('📱 Accelerometer started successfully');
                    this.showNotification('📱 Accelerometer monitoring started', 'success');

                } catch (error) {
                    this.log(`❌ Accelerometer error: ${error.message}`);
                    this.showNotification('❌ Failed to start accelerometer', 'error');
                }
            }

            stopAccelerometer() {
                window.removeEventListener('devicemotion', this.handleDeviceMotion.bind(this));
                this.sensors.accelerometer.active = false;
                this.updateSensorStatus('accelStatus', 'disconnected');
                this.updateButton('accelBtn', 'start', '🚀', 'Start Accelerometer');
                this.log('📱 Accelerometer stopped');
                this.showNotification('📱 Accelerometer monitoring stopped', 'warning');
            }

            handleDeviceMotion(event) {
                if (!this.sensors.accelerometer.active) return;

                const accel = event.accelerationIncludingGravity;
                if (!accel) return;

                const x = accel.x || 0;
                const y = accel.y || 0;
                const z = accel.z || 0;
                const magnitude = Math.sqrt(x*x + y*y + z*z);

                this.sensors.accelerometer.data = { x, y, z, magnitude };
                
                // Update UI
                document.getElementById('accelX').textContent = x.toFixed(2);
                document.getElementById('accelY').textContent = y.toFixed(2);
                document.getElementById('accelZ').textContent = z.toFixed(2);
                document.getElementById('accelMagnitude').textContent = magnitude.toFixed(2);

                // Store history for chart
                this.sensors.accelerometer.history.push({
                    timestamp: Date.now(),
                    x, y, z, magnitude
                });

                if (this.sensors.accelerometer.history.length > 50) {
                    this.sensors.accelerometer.history.shift();
                }

                this.updateChart('accelChart', this.sensors.accelerometer.history.map(d => d.magnitude));
                
                // Log significant movement
                if (magnitude > 15) {
                    this.logToStream('accelStream', `High motion detected: ${magnitude.toFixed(2)} m/s²`);
                }
            }

            // Light Sensor Functions
            startLightSensor() {
                this.sensors.light.active = true;
                this.updateSensorStatus('lightStatus', 'connected');
                this.updateButton('lightBtn', 'stop', '⏹️', 'Stop Light Monitoring');
                
                // Start light level monitoring
                this.lightMonitoringInterval = setInterval(() => {
                    this.estimateLightLevel();
                }, 1000);

                this.log('💡 Light sensor monitoring started');
                this.showNotification('💡 Light monitoring started', 'success');
            }

            stopLightSensor() {
                this.sensors.light.active = false;
                this.updateSensorStatus('lightStatus', 'disconnected');
                this.updateButton('lightBtn', 'start', '🌟', 'Start Light Monitoring');
                
                if (this.lightMonitoringInterval) {
                    clearInterval(this.lightMonitoringInterval);
                }

                this.log('💡 Light sensor monitoring stopped');
                this.showNotification('💡 Light monitoring stopped', 'warning');
            }

            estimateLightLevel() {
                if (!this.sensors.light.active) return;

                // Estimate light level based on screen brightness and time of day
                const hour = new Date().getHours();
                let baseLevel = 0;

                // Simulate light levels based on time of day
                if (hour >= 6 && hour < 8) baseLevel = 100; // Dawn
                else if (hour >= 8 && hour < 18) baseLevel = 800; // Day
                else if (hour >= 18 && hour < 20) baseLevel = 200; // Dusk
                else baseLevel = 10; // Night

                // Add some variation
                const variation = (Math.random() - 0.5) * 100;
                const lightLevel = Math.max(0, baseLevel + variation);

                let condition = 'Unknown';
                if (lightLevel < 50) condition = 'Dark';
                else if (lightLevel < 200) condition = 'Dim';
                else if (lightLevel < 500) condition = 'Indoor';
                else if (lightLevel < 1000) condition = 'Bright';
                else condition = 'Very Bright';

                this.sensors.light.data = { level: lightLevel, condition };

                // Update UI
                document.getElementById('lightLevel').textContent = Math.round(lightLevel);
                document.getElementById('lightCondition').textContent = condition;

                // Store history
                this.sensors.light.history.push({
                    timestamp: Date.now(),
                    level: lightLevel
                });

                if (this.sensors.light.history.length > 50) {
                    this.sensors.light.history.shift();
                }

                this.updateChart('lightChart', this.sensors.light.history.map(d => d.level));
                
                // Log changes
                this.logToStream('lightStream', `Light: ${Math.round(lightLevel)} lux (${condition})`);
            }

            // Audio Analysis Functions
            async startAudioAnalysis() {
                try {
                    document.getElementById('audioPermission').style.display = 'block';
                    
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    document.getElementById('audioPermission').style.display = 'none';
                    
                    this.sensors.audio.stream = stream;
                    this.sensors.audio.context = new (window.AudioContext || window.webkitAudioContext)();
                    
                    const source = this.sensors.audio.context.createMediaStreamSource(stream);
                    this.sensors.audio.analyser = this.sensors.audio.context.createAnalyser();
                    
                    this.sensors.audio.analyser.fftSize = 256;
                    source.connect(this.sensors.audio.analyser);
                    
                    this.sensors.audio.active = true;
                    this.updateSensorStatus('audioStatus', 'connected');
                    this.updateButton('audioBtn', 'stop', '⏹️', 'Stop Audio Analysis');
                    
                    this.startAudioLoop();
                    this.log('🎤 Audio analysis started successfully');
                    this.showNotification('🎤 Audio analysis started', 'success');

                } catch (error) {
                    document.getElementById('audioPermission').style.display = 'none';
                    this.log(`❌ Audio error: ${error.message}`);
                    this.showNotification('❌ Microphone access denied', 'error');
                }
            }

            stopAudioAnalysis() {
                if (this.sensors.audio.stream) {
                    this.sensors.audio.stream.getTracks().forEach(track => track.stop());
                }
                if (this.sensors.audio.context) {
                    this.sensors.audio.context.close();
                }

                this.sensors.audio.active = false;
                this.sensors.audio.stream = null;
                this.sensors.audio.context = null;
                this.sensors.audio.analyser = null;
                
                this.updateSensorStatus('audioStatus', 'disconnected');
                this.updateButton('audioBtn', 'start', '🎵', 'Start Audio Analysis');
                
                this.log('🎤 Audio analysis stopped');
                this.showNotification('🎤 Audio analysis stopped', 'warning');
            }

            startAudioLoop() {
                if (!this.sensors.audio.active || !this.sensors.audio.analyser) return;

                const bufferLength = this.sensors.audio.analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                const frequencyArray = new Uint8Array(bufferLength);

                const analyzeAudio = () => {
                    if (!this.sensors.audio.active) return;

                    this.sensors.audio.analyser.getByteTimeDomainData(dataArray);
                    this.sensors.audio.analyser.getByteFrequencyData(frequencyArray);

                    // Calculate volume (RMS)
                    let sum = 0;
                    for (let i = 0; i < bufferLength; i++) {
                        const sample = (dataArray[i] - 128) / 128;
                        sum += sample * sample;
                    }
                    const rms = Math.sqrt(sum / bufferLength);
                    const volume = Math.round(20 * Math.log10(rms + 0.001));

                    // Find peak frequency
                    let maxIndex = 0;
                    let maxValue = 0;
                    for (let i = 0; i < frequencyArray.length; i++) {
                        if (frequencyArray[i] > maxValue) {
                            maxValue = frequencyArray[i];
                            maxIndex = i;
                        }
                    }
                    const frequency = Math.round(maxIndex * this.sensors.audio.context.sampleRate / (2 * bufferLength));

                    // Determine activity level
                    let activity = 'Quiet';
                    if (volume > -30) activity = 'Very Loud';
                    else if (volume > -40) activity = 'Loud';
                    else if (volume > -50) activity = 'Moderate';
                    else if (volume > -60) activity = 'Low';

                    this.sensors.audio.data = { volume, frequency, activity };

                    // Update UI
                    document.getElementById('audioVolume').textContent = volume;
                    document.getElementById('audioFreq').textContent = frequency;
                    document.getElementById('audioActivity').textContent = activity;

                    // Update visualizer
                    this.updateAudioVisualizer(frequencyArray);
                    
                    // Log activity changes
                    if (activity !== 'Quiet') {
                        this.logToStream('audioStream', `Audio: ${volume}dB, ${frequency}Hz (${activity})`);
                    }

                    requestAnimationFrame(analyzeAudio);
                };

                analyzeAudio();
            }

            updateAudioVisualizer(frequencyData) {
                const bars = document.querySelectorAll('.audio-bar');
                const binSize = Math.floor(frequencyData.length / bars.length);

                bars.forEach((bar, index) => {
                    let sum = 0;
                    for (let i = 0; i < binSize; i++) {
                        sum += frequencyData[index * binSize + i];
                    }
                    const average = sum / binSize;
                    const height = Math.max(4, (average / 255) * 60);
                    bar.style.height = `${height}px`;
                });
            }

            // Chart Management
            setupCharts() {
                ['accelChart', 'lightChart'].forEach(id => {
                    const canvas = document.getElementById(id);
                    if (canvas) {
                        const ctx = canvas.getContext('2d');
                        canvas.width = canvas.offsetWidth;
                        canvas.height = canvas.offsetHeight;
                        this.charts[id] = { canvas, ctx };
                    }
                });
            }

            updateChart(chartId, data) {
                const chart = this.charts[chartId];
                if (!chart || !data.length) return;

                const { canvas, ctx } = chart;
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const maxValue = Math.max(...data, 1);
                const minValue = Math.min(...data, 0);
                const range = maxValue - minValue || 1;

                ctx.strokeStyle = '#667eea';
                ctx.lineWidth = 2;
                ctx.beginPath();

                data.forEach((value, index) => {
                    const x = (index / (data.length - 1)) * canvas.width;
                    const y = canvas.height - ((value - minValue) / range) * canvas.height;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });

                ctx.stroke();
            }

            // Utility Functions
            updateSensorStatus(statusId, status) {
                const element = document.getElementById(statusId);
                if (element) {
                    element.className = `status-indicator ${status}`;
                }
            }

            updateButton(buttonId, state, icon, text) {
                const button = document.getElementById(buttonId);
                if (button) {
                    button.className = state === 'stop' ? 'btn stop' : 'btn';
                    button.innerHTML = `<span>${icon}</span><span>${text}</span>`;
                }
            }

            checkPermissions() {
                // Check for motion permission support
                if (typeof DeviceMotionEvent !== 'undefined' && 
                    typeof DeviceMotionEvent.requestPermission === 'function') {
                    this.log('📱 iOS motion permissions detected');
                }

                // Check for audio support
                if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                    this.log('🎤 Audio analysis supported');
                } else {
                    this.log('❌ Audio analysis not supported');
                }
            }

            log(message) {
                console.log(message);
            }

            logToStream(streamId, message) {
                const stream = document.getElementById(streamId);
                if (stream) {
                    const entry = document.createElement('div');
                    entry.className = 'log-entry';
                    entry.innerHTML = `
                        <div class="log-timestamp">${new Date().toLocaleTimeString()}</div>
                        <div>${message}</div>
                    `;
                    stream.appendChild(entry);
                    stream.scrollTop = stream.scrollHeight;

                    // Keep only last 20 entries
                    while (stream.children.length > 20) {
                        stream.removeChild(stream.firstChild);
                    }
                }
            }

            showNotification(message, type = 'info') {
                showNotification(message, type);
            }
        }

        // ====================================
        // EMOTIONAL FUSION ENGINE INTEGRATION
        // ====================================
        
        class EmotionalFusionEngine {
            constructor() {
                this.isActive = false;
                this.sensors = {
                    facial: { active: false, quality: 0 },
                    voice: { active: false, quality: 0 },
                    biometric: { active: true, quality: 95 }
                };
                
                this.data = {
                    emotions: {
                        happy: 0, sad: 0, angry: 0, 
                        fearful: 0, surprised: 0, neutral: 0
                    },
                    biometrics: {
                        heartRate: 72, hrv: 45, stressLevel: 25,
                        respRate: 16, voiceStress: 'Low'
                    },
                    correlations: {
                        hrEmotion: 0.87, hrvEmotion: 0.73,
                        stressEmotion: 0.91, voiceEmotion: 0.68,
                        overallFusion: 0.84, confidence: 94
                    },
                    fusionHistory: [],
                    patterns: []
                };
                
                this.mediaStreams = {
                    facial: null,
                    voice: null
                };
                
                this.init();
            }
            
            init() {
                this.log('🧠 Emotional Fusion Engine initializing...', 'info');
                this.startDataSimulation();
                this.calculateCorrelations();
                this.log('✅ Emotional Fusion Engine ready', 'success');
                this.showNotification('🧠💓 Emotional Fusion Engine initialized!', 'success');
            }
            
            // Core Fusion Algorithm
            calculateEmotionalFusion() {
                const emotions = this.data.emotions;
                const biometrics = this.data.biometrics;
                
                // Heart Rate - Emotion Correlation
                const hrEmotionMap = {
                    happy: this.mapBiometricToEmotion(biometrics.heartRate, 70, 85, 0.8),
                    angry: this.mapBiometricToEmotion(biometrics.heartRate, 80, 100, 0.9),
                    fearful: this.mapBiometricToEmotion(biometrics.heartRate, 85, 110, 0.85),
                    surprised: this.mapBiometricToEmotion(biometrics.heartRate, 75, 90, 0.7),
                    sad: this.mapBiometricToEmotion(biometrics.heartRate, 60, 75, 0.6),
                    neutral: this.mapBiometricToEmotion(biometrics.heartRate, 65, 75, 0.5)
                };
                
                // Stress - Emotion Correlation
                const stressEmotionMap = {
                    angry: this.mapBiometricToEmotion(biometrics.stressLevel, 70, 100, 0.95),
                    fearful: this.mapBiometricToEmotion(biometrics.stressLevel, 60, 90, 0.9),
                    sad: this.mapBiometricToEmotion(biometrics.stressLevel, 40, 70, 0.7),
                    happy: this.mapBiometricToEmotion(100 - biometrics.stressLevel, 60, 90, 0.8),
                    surprised: this.mapBiometricToEmotion(biometrics.stressLevel, 30, 60, 0.6),
                    neutral: this.mapBiometricToEmotion(100 - biometrics.stressLevel, 70, 90, 0.5)
                };
                
                // Fusion calculation
                const fusedEmotions = {};
                Object.keys(emotions).forEach(emotion => {
                    const hrWeight = 0.4;
                    const stressWeight = 0.4;
                    const hrvWeight = 0.2;
                    
                    fusedEmotions[emotion] = Math.round(
                        (hrEmotionMap[emotion] * hrWeight +
                         stressEmotionMap[emotion] * stressWeight) *
                        this.getSensorConfidenceMultiplier()
                    );
                });
                
                return fusedEmotions;
            }
            
            mapBiometricToEmotion(value, minRange, maxRange, correlation) {
                const normalized = Math.max(0, Math.min(100, 
                    ((value - minRange) / (maxRange - minRange)) * 100
                ));
                return normalized * correlation;
            }
            
            getSensorConfidenceMultiplier() {
                const activeSensors = Object.values(this.sensors).filter(s => s.active).length;
                const avgQuality = Object.values(this.sensors)
                    .filter(s => s.active)
                    .reduce((sum, s) => sum + s.quality, 0) / Math.max(1, activeSensors);
                
                return (avgQuality / 100) * (1 + (activeSensors - 1) * 0.1);
            }
            
            calculateCorrelations() {
                const emotions = this.data.emotions;
                const biometrics = this.data.biometrics;
                
                this.data.correlations.hrEmotion = 0.7 + Math.random() * 0.25;
                this.data.correlations.stressEmotion = 0.7 + Math.random() * 0.25;
                this.data.correlations.hrvEmotion = 0.7 + Math.random() * 0.25;
                
                this.updateCorrelationDisplay();
            }
            
            updateCorrelationDisplay() {
                const correlations = this.data.correlations;
                
                updateElement('hrEmotionCorr', correlations.hrEmotion.toFixed(2));
                updateElement('hrvEmotionCorr', correlations.hrvEmotion.toFixed(2));
                updateElement('stressEmotionCorr', correlations.stressEmotion.toFixed(2));
                updateElement('voiceEmotionCorr', correlations.voiceEmotion.toFixed(2));
                updateElement('overallFusion', correlations.overallFusion.toFixed(2));
                updateElement('confidence', correlations.confidence + '%');
            }
            
            // Sensor Integration
            async startFacialEmotion() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({
                        video: { facingMode: 'user' }
                    });
                    
                    const video = document.getElementById('facialVideo');
                    video.srcObject = stream;
                    video.classList.remove('hidden');
                    
                    this.mediaStreams.facial = stream;
                    this.sensors.facial.active = true;
                    this.sensors.facial.quality = 85;
                    
                    this.startFacialAnalysis();
                    this.log('📷 Facial emotion analysis started', 'success');
                    this.showNotification('📷 Facial analysis active!', 'success');
                    
                } catch (error) {
                    this.log(`❌ Facial analysis failed: ${error.message}`, 'error');
                    this.showNotification('❌ Camera access denied', 'error');
                }
            }
            
            stopFacialEmotion() {
                if (this.mediaStreams.facial) {
                    this.mediaStreams.facial.getTracks().forEach(track => track.stop());
                    this.mediaStreams.facial = null;
                }
                
                const video = document.getElementById('facialVideo');
                video.classList.add('hidden');
                
                this.sensors.facial.active = false;
                this.sensors.facial.quality = 0;
                
                this.log('📷 Facial emotion analysis stopped', 'info');
                this.showNotification('📷 Facial analysis stopped', 'info');
            }
            
            async startVoiceEmotion() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({
                        audio: true
                    });
                    
                    this.mediaStreams.voice = stream;
                    this.sensors.voice.active = true;
                    this.sensors.voice.quality = 80;
                    
                    this.startVoiceAnalysis();
                    this.log('🎤 Voice emotion analysis started', 'success');
                    this.showNotification('🎤 Voice analysis active!', 'success');
                    
                } catch (error) {
                    this.log(`❌ Voice analysis failed: ${error.message}`, 'error');
                    this.showNotification('❌ Microphone access denied', 'error');
                }
            }
            
            stopVoiceEmotion() {
                if (this.mediaStreams.voice) {
                    this.mediaStreams.voice.getTracks().forEach(track => track.stop());
                    this.mediaStreams.voice = null;
                }
                
                this.sensors.voice.active = false;
                this.sensors.voice.quality = 0;
                
                this.log('🎤 Voice emotion analysis stopped', 'info');
                this.showNotification('🎤 Voice analysis stopped', 'info');
            }
            
            startFacialAnalysis() {
                const interval = setInterval(() => {
                    if (!this.sensors.facial.active) {
                        clearInterval(interval);
                        return;
                    }
                    
                    this.updateFacialEmotions();
                    this.updateProgress('facialProgress', this.sensors.facial.quality);
                }, 1000);
            }
            
            startVoiceAnalysis() {
                const interval = setInterval(() => {
                    if (!this.sensors.voice.active) {
                        clearInterval(interval);
                        return;
                    }
                    
                    this.updateVoiceEmotions();
                    this.updateProgress('voiceProgress', this.sensors.voice.quality);
                }, 1000);
            }
            
            updateFacialEmotions() {
                const dominant = ['happy', 'neutral', 'surprised'][Math.floor(Math.random() * 3)];
                
                Object.keys(this.data.emotions).forEach(emotion => {
                    if (emotion === dominant) {
                        this.data.emotions[emotion] = 60 + Math.random() * 30;
                    } else {
                        this.data.emotions[emotion] = Math.random() * 20;
                    }
                });
                
                this.fuseEmotionalData();
            }
            
            updateVoiceEmotions() {
                const stressLevel = Math.random() * 40 + 10;
                this.data.biometrics.voiceStress = stressLevel > 25 ? 'High' : 'Low';
                
                if (stressLevel > 30) {
                    this.data.emotions.angry += 10;
                    this.data.emotions.fearful += 8;
                } else {
                    this.data.emotions.happy += 5;
                    this.data.emotions.neutral += 5;
                }
                
                this.fuseEmotionalData();
            }
            
            fuseEmotionalData() {
                const fusedEmotions = this.calculateEmotionalFusion();
                
                Object.keys(fusedEmotions).forEach(emotion => {
                    this.data.emotions[emotion] = fusedEmotions[emotion];
                    this.updateElement(emotion, fusedEmotions[emotion] + '%');
                    
                    const hr = this.data.biometrics.heartRate;
                    this.updateElement(emotion + 'Corr', `HR: ${hr}`);
                });
                
                this.calculateCorrelations();
                this.storeFusionHistory();
            }
            
            storeFusionHistory() {
                const timestamp = Date.now();
                const snapshot = {
                    timestamp,
                    emotions: { ...this.data.emotions },
                    biometrics: { ...this.data.biometrics },
                    correlations: { ...this.data.correlations },
                    sensors: Object.fromEntries(
                        Object.entries(this.sensors).map(([k, v]) => [k, v.active])
                    )
                };
                
                this.data.fusionHistory.push(snapshot);
                
                if (this.data.fusionHistory.length > 100) {
                    this.data.fusionHistory.shift();
                }
            }
            
            startDataSimulation() {
                setInterval(() => {
                    this.simulateBiometricData();
                    if (!this.sensors.facial.active && !this.sensors.voice.active) {
                        this.simulateEmotionData();
                    }
                    this.fuseEmotionalData();
                }, 2000);
            }
            
            simulateBiometricData() {
                this.data.biometrics.heartRate = 65 + Math.floor(Math.random() * 25);
                this.data.biometrics.hrv = 30 + Math.floor(Math.random() * 30);
                this.data.biometrics.stressLevel = 15 + Math.floor(Math.random() * 40);
                this.data.biometrics.respRate = 14 + Math.floor(Math.random() * 6);
                
                this.updateElement('heartRate', this.data.biometrics.heartRate + ' BPM');
                this.updateElement('hrv', this.data.biometrics.hrv + ' ms');
                this.updateElement('stressLevel', this.data.biometrics.stressLevel + '%');
                this.updateElement('respRate', this.data.biometrics.respRate + ' /min');
            }
            
            simulateEmotionData() {
                const emotionPattern = Math.random();
                
                if (emotionPattern < 0.4) {
                    this.data.emotions.happy = 50 + Math.random() * 30;
                    this.data.emotions.neutral = 30 + Math.random() * 20;
                    this.data.emotions.sad = Math.random() * 10;
                    this.data.emotions.angry = Math.random() * 10;
                } else if (emotionPattern < 0.7) {
                    this.data.emotions.neutral = 60 + Math.random() * 25;
                    this.data.emotions.happy = Math.random() * 20;
                    this.data.emotions.sad = Math.random() * 15;
                } else {
                    this.data.emotions.angry = 20 + Math.random() * 25;
                    this.data.emotions.fearful = 15 + Math.random() * 20;
                    this.data.emotions.happy = Math.random() * 10;
                }
                
                this.data.emotions.surprised = Math.random() * 15;
            }
            
            initializeFusion() {
                this.isActive = true;
                this.log('🧠 Fusion engine initialized', 'success');
                this.showNotification('🧠 Fusion engine active!', 'success');
            }
            
            calibrateSensors() {
                this.log('⚙️ Calibrating sensors...', 'info');
                setTimeout(() => {
                    Object.keys(this.sensors).forEach(sensor => {
                        if (this.sensors[sensor].active) {
                            this.sensors[sensor].quality = 90 + Math.random() * 10;
                        }
                    });
                    this.log('✅ Sensor calibration complete', 'success');
                    this.showNotification('⚙️ Sensors calibrated!', 'success');
                }, 2000);
            }
            
            startRealTimeFusion() {
                this.log('🚀 Real-time fusion started', 'success');
                this.showNotification('🚀 Real-time fusion active!', 'success');
            }
            
            exportFusionData() {
                const exportData = {
                    timestamp: new Date().toISOString(),
                    current: this.data,
                    history: this.data.fusionHistory
                };
                
                const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                    type: 'application/json'
                });
                
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'emotional-fusion-data.json';
                a.click();
                
                this.log('📁 Fusion data exported', 'success');
                this.showNotification('📁 Data exported successfully!', 'success');
            }
            
            updateElement(id, value) {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                }
            }
            
            updateProgress(id, value) {
                const element = document.getElementById(id);
                if (element) {
                    element.style.width = value + '%';
                }
            }
            
            log(message, type = 'info') {
                const logContainer = document.getElementById('activityLog');
                if (logContainer) {
                    const entry = document.createElement('div');
                    entry.className = `log-entry ${type}`;
                    entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
                    
                    logContainer.appendChild(entry);
                    logContainer.scrollTop = logContainer.scrollHeight;
                    
                    while (logContainer.children.length > 50) {
                        logContainer.removeChild(logContainer.firstChild);
                    }
                }
            }
            
            showNotification(message, type = 'info') {
                showNotification(message, type);
            }
        }

        // ====================================
        // ENHANCED AI CONVERSATION ENGINE WITH QUANTUM INTELLIGENCE
        // ====================================
        
        // Advanced context and personalization data
        let conversationContext = {
            personality: 'Analytical-Achiever',
            currentMood: 'Focused',
            energyLevel: 82,
            timeOfDay: 'morning',
            recentActivities: ['meditation', 'planning'],
            goalContext: 'productivity',
            communicationStyle: 'data-driven',
            learningPreference: 'structured',
            quantumCoherence: 87,
            optimizationScore: 91
        };

        // Enhanced context functions
        function updateConversationContext(message, hour) {
            // Update time-based context
            if (hour < 12) conversationContext.timeOfDay = 'morning';
            else if (hour < 17) conversationContext.timeOfDay = 'afternoon';
            else conversationContext.timeOfDay = 'evening';
            
            // Update goal context based on message
            if (message.includes('work') || message.includes('focus')) {
                conversationContext.goalContext = 'productivity';
            } else if (message.includes('health') || message.includes('wellness')) {
                conversationContext.goalContext = 'health';
            } else if (message.includes('learn') || message.includes('grow')) {
                conversationContext.goalContext = 'growth';
            }
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            const currentTime = new Date();
            const hour = currentTime.getHours();
            
            // Real-time context adaptation
            updateConversationContext(lowerMessage, hour);
            
            // Enhanced personalization based on analytical personality
            const personalizedPrefix = getPersonalizedPrefix();
            const contextualInsights = getContextualInsights();
            
            let baseResponse = '';
            
            if (lowerMessage.includes('quantum')) {
                baseResponse = generateQuantumResponse(lowerMessage);
            } else if (lowerMessage.includes('sensor') || lowerMessage.includes('phone')) {
                baseResponse = generateSensorResponse(lowerMessage);
            } else if (lowerMessage.includes('fusion') || lowerMessage.includes('emotional') || lowerMessage.includes('biometric')) {
                baseResponse = `🧠💓 **Emotional Fusion Engine Analysis**\n\nCurrent Status:\n• Heart Rate: ${fusionEngine.data.biometrics.heartRate} BPM\n• Stress Level: ${fusionEngine.data.biometrics.stressLevel}%\n• Emotional Coherence: ${(fusionEngine.data.correlations.overallFusion * 100).toFixed(1)}%\n\n**Active Correlations:**\n• HR-Emotion: ${fusionEngine.data.correlations.hrEmotion.toFixed(2)}\n• Stress-Emotion: ${fusionEngine.data.correlations.stressEmotion.toFixed(2)}\n• Voice-Emotion: ${fusionEngine.data.correlations.voiceEmotion.toFixed(2)}\n\n**Fusion Confidence:** ${fusionEngine.data.correlations.confidence}%\n\nThe emotional fusion engine is actively monitoring your biometric-emotional state. Would you like to explore specific correlations or start advanced sensor analysis?`;
            } else if (lowerMessage.includes('energy') || lowerMessage.includes('boost')) {
                baseResponse = `${personalizedPrefix} **Energy Optimization Analysis**\n\n${getRealtimeDataSummary()}\n\n**Personalized Recommendations:**\n${getPersonalizedEnergyRecs()}\n\n${contextualInsights}`;
            } else if (lowerMessage.includes('briefing')) {
                baseResponse = generateDailyBriefing();
            } else if (lowerMessage.includes('screen') || lowerMessage.includes('screentime')) {
                baseResponse = `📱 **Context-Aware Screen Intelligence**\n\n${getScreenTimeAnalysis()}\n\n**Personality-Adapted Patterns:**\n• Analytical focus blocks: 92% efficiency during peak\n• Data-driven task scheduling: Optimal alignment\n• Systematic break patterns: Supporting deep work\n\n**Real-Time Optimization:**\n${getPersonalizedScreenRecs()}\n\n${contextualInsights}`;
            } else {
                // Default enhanced response with full context
                baseResponse = `${personalizedPrefix} I'm analyzing your request with **Quantum-Enhanced AI** active.\n\n**Current Context:**\n• ${getContextSummary()}\n• Biometric state: ${interpretBiometricState()}\n• Optimal window: Peak performance detected\n\n**How can I leverage this context to help you optimize your ${conversationContext.goalContext}?**\n\n${contextualInsights}`;
            }
            
            return baseResponse;
        }

        function generateSensorResponse(message) {
            if (phoneSensorsManager) {
                const accelActive = phoneSensorsManager.sensors.accelerometer.active;
                const lightActive = phoneSensorsManager.sensors.light.active;
                const audioActive = phoneSensorsManager.sensors.audio.active;
                
                return `📱 **Phone Sensors Analysis**\n\n**Sensor Status:**\n• Accelerometer: ${accelActive ? 'Active' : 'Inactive'}\n• Light Sensor: ${lightActive ? 'Active' : 'Inactive'}\n• Audio Analysis: ${audioActive ? 'Active' : 'Inactive'}\n\n**Current Readings:**\n• Motion: ${phoneSensorsManager.sensors.accelerometer.data.magnitude.toFixed(2)} m/s²\n• Light Level: ${Math.round(phoneSensorsManager.sensors.light.data.level)} lux\n• Environment: ${phoneSensorsManager.sensors.light.data.condition}\n• Audio Activity: ${phoneSensorsManager.sensors.audio.data.activity}\n\n**Integration Insights:**\nYour phone sensors provide valuable context for life optimization. Would you like me to correlate this data with your biometric and emotional patterns?`;
            }
            
            return `📱 **Phone Sensors Manager**\n\nAdvanced sensor integration ready. Access accelerometer, light sensor, and audio analysis through the floating sensors button (📱) to gather rich environmental context for AI optimization.`;
        }

        function generateQuantumResponse(message) {
            if (message.includes('briefing')) {
                return `⚛️ **Quantum-Optimized Daily Briefing**\n\n**Quantum State Analysis:**\n• Coherence Level: ${conversationContext.quantumCoherence.toFixed(1)}% (excellent)\n• Optimization Score: ${conversationContext.optimizationScore}% (${conversationContext.optimizationScore > 90 ? 'peak' : 'high'} performance)\n• Parallel Pathways: ${Math.floor(Math.random() * 3 + 4)} optimization routes identified\n\n**Quantum-Enhanced Recommendations:**\n${getQuantumOptimizedTasks()}\n\n**Entanglement Correlations:**\n${getQuantumEntanglements()}\n\n**Performance Prediction:**\n${getQuantumPredictions()}`;
            } else if (message.includes('superposition')) {
                return `💫 **Quantum Superposition Analysis**\n\n**Multiple Reality States Detected:**\n${getQuantumSuperpositionStates()}\n\n**Optimal Path Selection:**\n• Primary pathway: ${getOptimalQuantumPath()}\n• Probability of success: ${Math.round(85 + Math.random() * 12)}%\n• Alternative states available: ${Math.floor(Math.random() * 3 + 2)}\n\n**Quantum Decision Framework:**\n${getQuantumDecisionMatrix()}`;
            }
            
            return `⚛️ **Quantum Intelligence Active**\n\nQuantum processing engaged for your request. Current quantum coherence at ${conversationContext.quantumCoherence.toFixed(1)}% with ${Math.floor(Math.random() * 3 + 4)} parallel optimization pathways active.\n\nHow would you like to leverage quantum optimization for your life enhancement?`;
        }

        function generateDailyBriefing() {
            return `🌅 **AI Daily Briefing**\n\n**Energy Forecast:**\n• Current: ${conversationContext.energyLevel}% (Optimal)\n• Peak Window: 9:00-11:00 AM\n• Dip Alert: 2:17 PM\n\n**Priority Actions:**\n• Deep work: Project Alpha (peak energy window)\n• Hydration reminder before energy dip\n• Team meeting: Use afternoon social energy\n\n**Biometric Status:**\n• Heart Rate: 72 BPM (optimal for focus)\n• Stress: 15% (well managed)\n• HRV: 42ms (good recovery)\n\n**Personalized Insights:**\n• Your analytical profile aligns perfectly with morning tasks\n• 87% completion rate expected based on energy patterns\n• Social connections show 91% positive sentiment\n\n**Weather & Environment:**\n• Perfect conditions for outdoor break at 10:30 AM\n• Optimal lighting for screen work until 4 PM`;
        }

        function getQuantumOptimizedTasks() {
            return `1. **9:15-11:30 AM:** Quantum-optimal deep work window (94% efficiency)\n2. **2:17 PM:** Preventive energy management intervention\n3. **3:30-5:00 PM:** Social entanglement optimization period\n4. **7:00-8:30 PM:** Quantum learning integration session`;
        }

        function getQuantumEntanglements() {
            return `• Productivity ↔ Health: 0.87 correlation strength\n• Health ↔ Habits: 0.92 correlation strength\n• Learning ↔ Productivity: 0.78 correlation strength`;
        }

        function getQuantumPredictions() {
            return `Next 6 hours show ${Math.round(88 + Math.random() * 8)}% probability of peak performance with quantum optimization applied.`;
        }

        function getQuantumSuperpositionStates() {
            const states = [
                'State α: Focus on Project Alpha (probability: 0.73)',
                'State β: Optimize health metrics (probability: 0.68)',
                'State γ: Social connection enhancement (probability: 0.61)',
                'State δ: Learning acceleration (probability: 0.59)'
            ];
            return states.slice(0, Math.floor(Math.random() * 2 + 3)).join('\n• ');
        }

        function getOptimalQuantumPath() {
            const paths = ['Project Alpha deep work', 'Health optimization', 'Social enhancement', 'Learning acceleration'];
            return paths[Math.floor(Math.random() * paths.length)];
        }

        function getQuantumDecisionMatrix() {
            return `• Consider parallel outcomes simultaneously\n• Optimize for maximum life domain coherence\n• Minimize decoherence through strategic timing\n• Leverage entanglement effects for compound benefits`;
        }

        function getPersonalizedPrefix() {
            const prefixes = {
                'Analytical-Achiever': '🎯 **Data-Driven Analysis**',
                'Creative-Explorer': '✨ **Creative Intelligence**',
                'Social-Diplomat': '🤝 **Collaborative Insights**'
            };
            return prefixes[conversationContext.personality] || '🧠 **AI Analysis**';
        }

        function getRealtimeDataSummary() {
            return `**Real-Time Biometric Integration:**\n• Heart Rate: ${fusionEngine ? fusionEngine.data.biometrics.heartRate : 72} BPM (optimal for work)\n• Stress Level: ${fusionEngine ? fusionEngine.data.biometrics.stressLevel : 25}% (well managed)\n• HRV: ${fusionEngine ? fusionEngine.data.biometrics.hrv : 45}ms (good recovery)\n• Energy: ${conversationContext.energyLevel}% (high performance state)`;
        }

        function getContextualInsights() {
            const timeInsights = {
                'morning': 'Peak analytical window - optimal for complex problem-solving',
                'afternoon': 'Social energy rising - good for collaboration and communication',
                'evening': 'Reflection mode - ideal for planning and review'
            };
            return `💡 **Contextual Insight:** ${timeInsights[conversationContext.timeOfDay]}`;
        }

        function getPersonalizedEnergyRecs() {
            return `1. **Analytical Deep Work:** Next 47 minutes optimal\n2. **Systematic Breaks:** 5-min structured intervals\n3. **Data Review:** Perfect timing for complex analysis\n4. **Strategic Planning:** Cognitive peak window active`;
        }

        function getScreenTimeAnalysis() {
            return `**Today's Usage Patterns:**\n• Productive time: 4.2h (68% of total)\n• Social engagement: 1.8h (29%)\n• Distraction time: 0.3h (3%)\n\n**Efficiency Metrics:**\n• Morning focus: 92% productive (9-11 AM)\n• Afternoon collaboration: 73% social effectiveness\n• Evening planning: 81% reflective activities`;
        }

        function getPersonalizedScreenRecs() {
            return `• Schedule analytical tasks: 9-11 AM peak window\n• Use afternoon energy for meetings and communication\n• Evening: reflection and planning activities\n• Limit notification interrupts during deep work`;
        }

        function getContextSummary() {
            return `Energy: ${conversationContext.energyLevel}% • Mood: ${conversationContext.currentMood} • Goal: ${conversationContext.goalContext}`;
        }

        function interpretBiometricState() {
            return `Heart rate optimal, stress managed, HRV good recovery`;
        }

        // ====================================
        // ENHANCED AI PLATFORM CORE FUNCTIONS
        // ====================================

        let currentSection = 'aiCoach';
        let currentHealthTab = 'overview';
        let currentPerformanceTab = 'productivity';
        let currentGrowthTab = 'learning';
        let currentProfileTab = 'achievements';
        let isListening = false;
        let fusionEngine = null;
        let phoneSensorsManager = null;
        let biometricMonitoring = true;

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Set initial section visibility
            switchSection('aiCoach');
            
            // Initialize default tabs
            setTimeout(() => {
                // Initialize health tab
                switchHealthTab('overview');
                // Initialize performance tab  
                switchPerformanceTab('productivity');
                // Initialize growth tab
                switchGrowthTab('learning');
                // Initialize profile tab
                switchProfileTab('achievements');
            }, 100);
            
            // Initialize all components
            setupProgressRings();
            setupEnergyForecast();
            setupScreenTimeBars();
            addWelcomeMessage();
            startProactiveInterventions();
            startBiometricSimulation();
            
            // Initialize Fusion Engine
            fusionEngine = new EmotionalFusionEngine();
            
            // Initialize Phone Sensors Manager
            phoneSensorsManager = new PhoneSensorsManager();
            
            // Setup input handlers
            setupInputHandlers();
            
            // Show welcome notification
            setTimeout(() => {
                showNotification('🚀 Enhanced AI Platform initialized successfully!', 'success');
            }, 1000);
            
            console.log('🚀 Enhanced AI Life Platform with Quantum Intelligence, Emotional Fusion Engine, and Phone Sensors initialized');
        }

        function setupInputHandlers() {
            const input = document.getElementById('messageInput');
            if (input) {
                input.addEventListener('input', function() {
                    adjustTextareaHeight(this);
                });

                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }
        }

        // ====================================
        // SECTION AND NAVIGATION FUNCTIONS
        // ====================================

        function switchSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.toggle('active', item.dataset.section === section);
            });
            
            currentSection = section;
        }

        function switchHealthTab(tabId, event) {
            // Remove active from all health tabs
            document.querySelectorAll('.health-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#health .sub-nav-item').forEach(item => item.classList.remove('active'));
            
            // Show target tab
            const targetTab = document.getElementById(`health${tabId.charAt(0).toUpperCase() + tabId.slice(1)}`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            // Update sub navigation
            if (event && event.target) {
                event.target.classList.add('active');
            }
            currentHealthTab = tabId;
        }

        function switchPerformanceTab(tabId, event) {
            document.querySelectorAll('.performance-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#performance .sub-nav-item').forEach(item => item.classList.remove('active'));
            
            const targetTab = document.getElementById(`performance${tabId.charAt(0).toUpperCase() + tabId.slice(1)}`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            currentPerformanceTab = tabId;
        }

        function switchGrowthTab(tabId, event) {
            document.querySelectorAll('.growth-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#growth .sub-nav-item').forEach(item => item.classList.remove('active'));
            
            const targetTab = document.getElementById(`growth${tabId.charAt(0).toUpperCase() + tabId.slice(1)}`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            currentGrowthTab = tabId;
        }

        function switchProfileTab(tabId) {
            if (['achievements', 'integrations', 'labs', 'analytics'].includes(tabId)) {
                document.querySelectorAll('.profile-tab').forEach(tab => {
                    tab.classList.remove('active');
                    tab.style.display = 'none';
                });
                
                const targetTab = document.getElementById(`profile${tabId.charAt(0).toUpperCase() + tabId.slice(1)}`);
                if (targetTab) {
                    targetTab.classList.add('active');
                    targetTab.style.display = 'block';
                }
                
                currentProfileTab = tabId;
            }
        }

        // ====================================
        // OVERLAY FUNCTIONS
        // ====================================

        function toggleLightSensor() {
            if (phoneSensorsManager.sensors.light.active) {
                phoneSensorsManager.stopLightSensor();
            } else {
                phoneSensorsManager.startLightSensor();
            }
        }

        function toggleAudioAnalysis() {
            if (phoneSensorsManager.sensors.audio.active) {
                phoneSensorsManager.stopAudioAnalysis();
            } else {
                phoneSensorsManager.startAudioAnalysis();
            }
        }

        // ====================================
        // CONVERSATION FUNCTIONS
        // ====================================

        function sendMessage() {
            const input = document.getElementById('messageInput');
            if (input && input.value.trim()) {
                const message = input.value.trim();
                input.value = '';
                adjustTextareaHeight(input);
                
                addMessage('user', message);
                processAIResponse(message);
            }
        }

        function sendQuickMessage(message) {
            addMessage('user', message);
            processAIResponse(message);
        }

        function processAIResponse(userMessage) {
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateAIResponse(userMessage);
                addMessage('ai', response, userMessage.toLowerCase().includes('quantum'));
            }, 1000 + Math.random() * 2000);
        }

        function addMessage(sender, content, isQuantum = false) {
            const conversationArea = document.getElementById('conversationArea');
            if (conversationArea) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;
                
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                const bubbleClass = sender === 'ai' && isQuantum ? 'message-bubble quantum' : 'message-bubble';
                
                messageDiv.innerHTML = `
                    <div class="${bubbleClass}">${content}</div>
                    <div class="message-time">${timeString}</div>
                `;
                
                conversationArea.appendChild(messageDiv);
                conversationArea.scrollTop = conversationArea.scrollHeight;
            }
        }

        function showTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.classList.add('active');
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.classList.remove('active');
        }

        function handleInputKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function adjustTextareaHeight(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        function toggleVoiceInput() {
            if (isListening) {
                stopVoiceInput();
            } else {
                startVoiceInput();
            }
        }

        function startVoiceInput() {
            isListening = true;
            const voiceButton = document.getElementById('voiceButton');
            if (voiceButton) {
                voiceButton.classList.add('listening');
                voiceButton.textContent = '🛑';
            }
            showNotification('🎤 Voice input activated', 'info');
            
            setTimeout(() => {
                stopVoiceInput();
                const sampleInput = "Show me emotional fusion analysis";
                document.getElementById('messageInput').value = sampleInput;
                sendMessage();
            }, 3000);
        }

        function stopVoiceInput() {
            isListening = false;
            const voiceButton = document.getElementById('voiceButton');
            if (voiceButton) {
                voiceButton.classList.remove('listening');
                voiceButton.textContent = '🎤';
            }
        }

        function addWelcomeMessage() {
            setTimeout(() => {
                addMessage('ai', '⚛️ Welcome to your Quantum-Enhanced AI Life Platform with Emotional Fusion Engine and Phone Sensors! I can help optimize your productivity, health, emotions, and goals using advanced biometric-emotional correlation analysis and environmental sensors. Ready to start?', true);
            }, 1000);
        }

        // ====================================
        // FUSION ENGINE FUNCTIONS (EXPOSED GLOBALLY)
        // ====================================

        function startFacialEmotion() {
            if (fusionEngine) {
                fusionEngine.startFacialEmotion();
            }
        }

        function stopFacialEmotion() {
            if (fusionEngine) {
                fusionEngine.stopFacialEmotion();
            }
        }

        function startVoiceEmotion() {
            if (fusionEngine) {
                fusionEngine.startVoiceEmotion();
            }
        }

        function stopVoiceEmotion() {
            if (fusionEngine) {
                fusionEngine.stopVoiceEmotion();
            }
        }

        function initializeFusion() {
            if (fusionEngine) {
                fusionEngine.initializeFusion();
            }
        }

        function calibrateSensors() {
            if (fusionEngine) {
                fusionEngine.calibrateSensors();
            }
        }

        function startRealTimeFusion() {
            if (fusionEngine) {
                fusionEngine.startRealTimeFusion();
            }
        }

        function exportFusionData() {
            if (fusionEngine) {
                fusionEngine.exportFusionData();
            }
        }

        // ====================================
        // FEATURE FUNCTIONS
        // ====================================

        function startBiometricMonitoring() {
            biometricMonitoring = true;
            showNotification('📱 Biometric monitoring started', 'success');
            updateBiometricDisplay();
        }

        function startCameraPPGMonitoring() {
            showNotification('📷 Camera PPG heart rate monitoring started', 'success');
        }

        function startMorningRitual() {
            showNotification('🌅 Starting personalized morning ritual...', 'info');
            setTimeout(() => {
                showNotification('🧘 Morning meditation completed (+15 XP)', 'success');
            }, 2000);
        }

        function startPersonalizedStack() {
            showNotification('🧬 Starting personalized morning stack...', 'info');
        }

        function optimizeEnergyAllocation() {
            showNotification('⚛️ Quantum optimizing energy allocation...', 'quantum');
            setTimeout(() => {
                showNotification('⚡ Energy allocation optimized!', 'success');
            }, 2000);
        }

        function startFocusSession() {
            showNotification('🎯 Starting 90-minute focus session...', 'info');
            openAICoach();
            setTimeout(() => {
                addMessage('ai', '🎯 **Deep Focus Session Initiated**\n\nOptimal conditions detected:\n• Heart rate: 72 BPM (perfect for concentration)\n• Stress level: 15% (ideal cognitive state)\n• Energy window: Peak performance active\n\nRecommendations:\n• Turn off notifications\n• Use analytical strengths for complex problems\n• 5-minute breaks every 25 minutes\n\nWhat\'s your primary focus objective?');
            }, 1000);
        }

        function optimizeProductivity() {
            showNotification('⚡ Optimizing productivity patterns...', 'info');
        }

        function energyOptimization() {
            showNotification('⚡ Analyzing energy patterns...', 'info');
            openAICoach();
        }

        function obstacleAnticipation() {
            showNotification('🛡️ Analyzing potential obstacles...', 'info');
            openAICoach();
        }

        function adaptToPersonality() {
            showNotification('🎭 Analytical-Achiever (87% confidence)', 'info');
            openAICoach();
        }

        function checkAchievements() {
            showNotification('🎮 Level 15 • 8,534 XP • 5 achievements', 'info');
        }

        function viewInterventionStats() {
            showNotification('🛡️ 23 interventions • 15 crashes prevented', 'info');
        }

        function triggerLearningActivity() {
            showNotification('📚 Learning activity completed! +30 XP earned', 'success');
        }

        function triggerEveningReflection() {
            showNotification('🌙 Starting evening reflection...', 'info');
            openAICoach();
        }

        function runAdvancedAnalysis() {
            showNotification('🎯 Running advanced multi-lab analysis...', 'quantum');
            setTimeout(() => {
                showNotification('✨ Advanced analysis complete!', 'success');
            }, 3000);
        }

        // ====================================
        // MULTIMODAL FUNCTIONS
        // ====================================

        function startVoiceJournal() {
            showNotification('🎙️ Voice journal with emotion detection started', 'info');
        }

        function startCameraMood() {
            showNotification('📷 Camera mood detection started', 'info');
        }

        function analyzeScreenTime() {
            showNotification('📱 Analyzing screen time patterns...', 'info');
            openAICoach();
            setTimeout(() => {
                addMessage('ai', '📱 **Screen Time Intelligence Analysis**\n\n**Today\'s Breakdown:**\n• Productive time: 4.2h (68% of total)\n• Social media: 1.8h (29%)\n• Distractions: 0.3h (3%)\n\n**Productivity Patterns:**\n• Peak focus: 9-11 AM (92% productive)\n• Afternoon dip: 2-4 PM (45% productive)\n• Evening recovery: 6-8 PM (73% productive)\n\n**Recommendations:**\n• Schedule demanding tasks in morning window\n• Use afternoon for social/communication\n• Limit distracting apps during peak hours\n\nYour screen usage shows excellent discipline!');
            }, 1000);
        }

        function uploadPhoto() {
            showNotification('📸 Photo analysis ready', 'info');
        }

        function uploadHealthPhoto() {
            showNotification('🥗 Health photo analyzed - nutrition insights ready', 'success');
        }

        function optimizeWorkout() {
            showNotification('💪 Generating personalized workout plan...', 'info');
        }

        // ====================================
        // INTEGRATION FUNCTIONS
        // ====================================

        function toggleIntegration(integrationName) {
            const integrations = {
                'calendar': 'Calendar Intelligence',
                'email': 'Email Sentiment Analysis',
                'biometric': 'Biometric Monitoring',
                'smarthome': 'Smart Home Integration',
                'financial': 'Financial Wellness',
                'wearables': 'Wearable Devices'
            };
            
            const name = integrations[integrationName];
            if (name) {
                showNotification(`${name} toggled`, 'info');
            }
        }

        function runQuantumIntegrationAnalysis() {
            showNotification('⚛️ Running quantum cross-platform analysis...', 'quantum');
            setTimeout(() => {
                showNotification('🌟 Quantum integration analysis complete!', 'success');
                updateIntegrationMetrics();
            }, 3000);
        }

        function updateIntegrationMetrics() {
            updateElement('connectedPlatforms', '3/6');
            updateElement('timeSavedWeek', '127 min');
            updateElement('crossPlatformCount', '4');
        }

        // ====================================
        // PROFILE FUNCTIONS
        // ====================================

        function openSettings() {
            showNotification('⚙️ Opening settings...', 'info');
        }

        // ====================================
        // OVERLAY FUNCTIONS CONTINUED
        // ====================================

        function openFusionEngine() {
            switchSection('emotionalFusion');
            showNotification('🧠💓 Emotional Fusion Engine opened', 'success');
        }

        function toggleAICoach() {
            switchSection('aiCoach');
        }

        function openAICoach() {
            switchSection('aiCoach');
        }

        function toggleSensorsOverlay() {
            const overlay = document.getElementById('sensorsOverlay');
            
            if (overlay && overlay.classList.contains('active')) {
                closeSensorsOverlay();
            } else {
                openSensorsOverlay();
            }
        }

        function openSensorsOverlay() {
            const overlay = document.getElementById('sensorsOverlay');
            
            if (overlay) {
                overlay.classList.add('active');
            }
            
            showNotification('📱 Phone Sensors Manager opened', 'success');
        }

        function closeSensorsOverlay() {
            const overlay = document.getElementById('sensorsOverlay');
            
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        function startFullConversation() {
            openAICoach();
        }

        function showQuantumStatus() {
            showNotification('⚛️ Quantum coherence: 87.3% | Optimization: 91.2%', 'quantum');
        }

        function toggleLabs() {
            const overlay = document.getElementById('labsOverlay');
            
            if (overlay && overlay.classList.contains('active')) {
                closeLabs();
            } else {
                openLabs();
            }
        }

        function openLabs() {
            const overlay = document.getElementById('labsOverlay');
            
            if (overlay) {
                overlay.classList.add('active');
            }
            
            showNotification('⚛️ Quantum AI Labs interface opened', 'quantum');
        }

        function closeLabs() {
            const overlay = document.getElementById('labsOverlay');
            
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        function openLab(labType) {
            if (labType === 'emotional-fusion') {
                closeLabs();
                openFusionEngine();
                return;
            }
            
            const labNames = {
                'deep-emotion': 'Deep Emotion Analysis',
                'personality': 'Personality Testing',
                'predictive': 'Predictive Intelligence',
                'multimodal': 'Multimodal Fusion',
                'quantum': 'Quantum Analysis',
                'biometric': 'Biometric Integration'
            };
            
            const labName = labNames[labType] || labType;
            showNotification(`⚛️ Initializing ${labName}...`, 'quantum');
            
            setTimeout(() => {
                closeLabs();
                openAICoach();
                
                setTimeout(() => {
                    const labResponse = generateLabResponse(labType, labName);
                    addMessage('ai', labResponse, labType === 'quantum');
                }, 1000);
                
                showNotification(`🧪 ${labName} analysis started`, 'success');
            }, 1500);
        }

        function generateLabResponse(labType, labName) {
            const responses = {
                'deep-emotion': `🔬 **Deep Emotion Analysis Laboratory**\n\n**Multimodal Emotion Fusion Active:**\n• Facial micro-expression: 94% accuracy\n• Voice pattern recognition: 89% confidence\n• Biometric correlation: Real-time fusion\n• Text sentiment: Advanced NLP\n\n**Current Reading:** Analytical Focus with Optimistic Undertones\n**Confidence:** 96.3%\n\nWhat aspect would you like to explore?`,
                
                'personality': `📊 **Personality Testing Laboratory**\n\n**Big Five + AI Assessment:**\n• Openness: 78% (High creativity)\n• Conscientiousness: 91% (Excellent discipline)\n• Extraversion: 65% (Balanced social energy)\n• Agreeableness: 82% (Collaborative)\n• Neuroticism: 23% (Emotionally stable)\n\n**AI Profile:** Analytical-Achiever\n**Confidence:** 87%\n\nReady for advanced profiling?`,
                
                'predictive': `🔮 **Predictive Intelligence Laboratory**\n\n**AI Forecasting Models:**\n• Energy prediction: 91% accuracy\n• Mood forecasting: 84% confidence\n• Productivity windows: 96% precision\n\n**Next 6 Hours:**\n⚡ Peak: 9:15-11:30 AM\n📉 Dip: 2:17 PM\n🎯 Optimal decisions: 10:45 AM\n\nWhich model would you like to explore?`,
                
                'quantum': `⚛️ **Quantum Analysis Laboratory**\n\n**Quantum Computing Simulation Active:**\n• Coherence Level: ${conversationContext.quantumCoherence.toFixed(1)}%\n• Optimization Score: ${conversationContext.optimizationScore}%\n• Parallel Processing: ${Math.floor(Math.random() * 3 + 4)} pathways\n• Entanglement Strength: 0.87\n\n**Quantum Algorithms Online:**\n• Quantum Annealing: Optimizing life domains\n• Superposition Search: Exploring possibilities\n• Entanglement Analysis: Mapping correlations\n\n**Ready for quantum-enhanced optimization?**`
            };
            
            return responses[labType] || `🔬 **${labName} Laboratory**\n\nAdvanced analysis capabilities initialized. This lab provides cutting-edge insights using AI-powered analysis. What would you like to explore?`;
        }

        // ====================================
        // PHONE SENSORS GLOBAL FUNCTIONS
        // ====================================

        function toggleAccelerometer() {
            if (phoneSensorsManager.sensors.accelerometer.active) {
                phoneSensorsManager.stopAccelerometer();
            } else {
                phoneSensorsManager.startAccelerometer();
            }
        }

        // ====================================
        // SETUP FUNCTIONS
        // ====================================

        function setupProgressRings() {
            const progressRings = document.querySelectorAll('.progress-ring .progress');
            progressRings.forEach(ring => {
                const percentage = 89;
                const offset = 251 - (251 * percentage / 100);
                ring.style.strokeDashoffset = offset;
            });
        }

        function setupEnergyForecast() {
            const forecastChart = document.getElementById('energyForecast');
            if (forecastChart) {
                const hours = 24;
                const bars = Array.from({ length: hours }, (_, i) => {
                    let className = 'forecast-bar';
                    if (i >= 9 && i <= 11) className += ' peak';
                    else if (i >= 14 && i <= 15) className += ' low';
                    return `<div class="${className}"></div>`;
                });
                forecastChart.innerHTML = bars.join('');
            }
        }

        function setupScreenTimeBars() {
            const screenBars = document.getElementById('screenBars');
            if (screenBars) {
                const hours = 24;
                const bars = Array.from({ length: hours }, (_, i) => {
                    let className = 'screen-bar';
                    let height = Math.random() * 100; // Random height for demo
                    
                    // Add activity type based on time
                    if (i >= 9 && i <= 17) { // Work hours - more productive
                        className += ' productive';
                        height = Math.max(height, 60);
                    } else if (i >= 18 && i <= 22) { // Evening - social
                        className += ' social';
                        height = Math.max(height, 40);
                    } else if (i >= 23 || i <= 6) { // Night/early morning - low activity
                        className += ' distraction';
                        height = Math.min(height, 20);
                    } else {
                        className += ' productive';
                    }
                    
                    return `<div class="${className}" style="height: ${height}%;"></div>`;
                });
                screenBars.innerHTML = bars.join('');
            }
        }

        function startProactiveInterventions() {
            const interventions = [
                { message: 'Quantum coherence analysis suggests optimal decision-making window active', type: 'quantum' },
                { message: 'Energy-productivity correlation at 94% - excellent alignment', type: 'success' },
                { message: 'Emotional coherence at 0.84 - peak focus state detected', type: 'success' },
                { message: 'Quantum entanglement patterns optimized for analytical profile', type: 'quantum' },
                { message: 'Stress-heart rate correlation improving - 0.73 strength', type: 'success' },
                { message: 'Superposition analysis reveals 5 parallel optimization pathways', type: 'quantum' },
                { message: 'Phone sensor data indicates optimal environmental conditions', type: 'success' }
            ];
            
            setInterval(() => {
                if (Math.random() < 0.12) {
                    const intervention = interventions[Math.floor(Math.random() * interventions.length)];
                    showNotification(`🧠 ${intervention.message}`, intervention.type);
                    updateElement('proactiveInsight', intervention.message);
                }
            }, 15000);
        }

        function startBiometricSimulation() {
            setInterval(() => {
                if (biometricMonitoring) {
                    updateBiometricData();
                    updateBiometricDisplay();
                }
            }, 3000);
        }

        function updateBiometricData() {
            if (fusionEngine) {
                fusionEngine.simulateBiometricData();
            }
        }

        function updateBiometricDisplay() {
            if (fusionEngine) {
                updateElement('heartRateDisplay', `${fusionEngine.data.biometrics.heartRate} BPM`);
                updateElement('bloodOxygenDisplay', `98%`);
                updateElement('stressDisplay', `${fusionEngine.data.biometrics.stressLevel}%`);
                updateElement('hrvDisplay', `${fusionEngine.data.biometrics.hrv}ms`);
                updateElement('skinConductanceDisplay', `0.8μS`);
                updateElement('breathingRateDisplay', `${fusionEngine.data.biometrics.respRate}/min`);
                updateElement('facialTensionDisplay', `12%`);
                
                // Update context display
                updateElement('contextEnergy', `${conversationContext.energyLevel}%`);
            }
        }

        // ====================================
        // UTILITY FUNCTIONS
        // ====================================

        function updateElement(id, content) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = content;
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type} show`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 400);
            }, 3000);
        }
    </script>
</body>
</html>